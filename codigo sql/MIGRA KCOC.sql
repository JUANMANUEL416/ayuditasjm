USE KCOCUT


SELECT  * INTO #A FROM CIT WHERE FECHA>='01/04/2025'

SELECT DISTINCT IDAFILIADO INTO #B FROM #A

DROP TABLE #C
SELECT AFI.* INTO #C FROM AFI INNER JOIN #B ON AFI.IDAFILIADO=#B.IDAFILIADO

ALTER TABLE #C ADD IDAFILIADOANT VARCHAR(20)

UPDATE #C SET IDAFILIADOANT=IDAFILIADO
SELECT  * FROM #C

UPDATE #C SET IDAFILIADO=AFI.IDAFILIADO
FROM #C INNER JOIN KCOC.DBO.AFI ON #C.DOCIDAFILIADO=AFI.DOCIDAFILIADO

SELECT  * FROM #C WHERE NOT EXISTS(SELECT * FROM KCOC.DBO.AFI B WHERE #C.DOCIDAFILIADO=B.DOCIDAFILIADO)
SELECT  * FROM #C WHERE NOT EXISTS(SELECT * FROM KCOC.DBO.AFI B WHERE #C.IDAFILIADO=B.IDAFILIADO)

ALTER TABLE #D ADD IDAFILIADOANT VARCHAR(20)

UPDATE #D SET NUMCARNET=IDAFILIADO

UPDATE #D SET IDAFILIADO='03'+RIGHT(IDAFILIADO,LEN(IDAFILIADO)-2)

SELECT DISTINCT CIUDAD FROM #D

UPDATE #D SET IDPAIS='57'

SELECT DBO.FNK_COLUMNAS_TABLAS('AFI')

INSERT INTO KCOC.DBO.AFI(IDAFILIADO, PAPELLIDO, SAPELLIDO, PNOMBRE, SNOMBRE, TIPO_DOC, DOCIDAFILIADO, IDALTERNA, IDAFILIADOPPAL, GRUPO_SANG, ESTADO_CIVIL, GRUPOETNICO, SEXO, IDPARENTESCO, LOCALIDAD, DIRECCION,  TELEFONORES, CIUDAD, ZONA, CODENTIDADANTERIOR, ESTADO, FECHAULTESTADO, IDSEDE, IDPROVEEDOR, FNACIMIENTO, FECHAAFILSGSSS, ACT_ECONO, IDESCOLARIDAD, INDCOTIZANTE, ULTIMOANOAPROBADO,  INCAPACIDADLABORAL, TIPODISCAPACIDAD, TIPOAFILIADO, GRUPOATESPECIAL, CABEZADEFAMILIA, ASOCIADO, TIENEOBS, CAMPOUSUARIO1, FECHAUVISITA, CONSANGUINIDAD, IDADMINISTRADORA, IDCAUSAL,  FECHACAUSAL, CLASIFPC, NIVELSOCIOEC, IDPLAN, FECHAAFILIACION, NUMCARNET, CIUDADDOC, IDEMPLEADOR, SEMANASCOT, CARNETIZADO, FECHACARNET, CONSCERTIFICADO, CIUDADNAC, IDOCUPACION,  NACIONALIDAD, CELULAR, DIRECCIONLAB, TELEFONOLAB, CNSAFIAA, SISBENNUMFICHA, SISBENFECHAFICHA, SISBENPUNTAJE, SISBENNUCLEOFAM, SISBENGRUPOB, IDCONTRATO, IDBARRIO, CLASEAFILIACIONARS,  FORMULARIO, EMAIL, NORADICACION, FECHARADICACION, IDTIPOAFILIACION, IDCLASEAFILIACION, V_FORMULARIO, SISBENNIVEL, CNSXCPA, FESTADO, OKBD, USUARIOBD, NACIMIENTO, ITFC, CNSITFC,  TIPOSUBSIDIO, COBERTURA_SALUD, TIPOAFILIADO2, IDAFI_TITULAR, ES_NN, IDESPECIAL, MTRIAGE, FTRIAGE, GRUPOPOB, IDSEDETRIAGE, F_ACTUALIZA, PRIORIDAD, URG_NOMBRE, URG_TELE, URG_DIR,  URG_VINCULO, RAIPOSITIVO, RAIFECHA, RAIUSU, USUARIOATIENDE, OBSERVACION, PORTABILIDAD, FIPORT, FFPORT, CORREGIMIENTO, IDFOTO, IDBARRIO_L, CIUDAD_L, CORREGIMIENTO_L, DIR_PPAL, LAT_DIR,  LNG_DIR, LAT_DIR_L, LNG_DIR_L, CLAVE, PIN, PROCEDENCIA, FECHACTIVACION, REFDIRPRINC, REFDIRLAB, PLANSALUD, USUPRORROGA, FECHAPRORROGA, CLASEPRORROGA, CRONICO, IDPAIS, RUC, IDMEMBRESIA,  FVMEMBRECIA, CONTRATANTE, DEPA, PRODUCTO, IDMEDCABECERA, FECHAFALLECE, CATEGORIA, PREFIJO_CELULAR, PREFIJO_TELEFONORES, TIPOUSUARIO)
SELECT DISTINCT IDAFILIADO, PAPELLIDO, SAPELLIDO, PNOMBRE, SNOMBRE, TIPO_DOC, DOCIDAFILIADO, IDALTERNA, IDAFILIADOPPAL, GRUPO_SANG, ESTADO_CIVIL, GRUPOETNICO, SEXO, IDPARENTESCO, LOCALIDAD, DIRECCION,  TELEFONORES, CIUDAD, ZONA, CODENTIDADANTERIOR, ESTADO, FECHAULTESTADO, IDSEDE, IDPROVEEDOR, FNACIMIENTO, FECHAAFILSGSSS, ACT_ECONO, IDESCOLARIDAD, INDCOTIZANTE, ULTIMOANOAPROBADO,  INCAPACIDADLABORAL, TIPODISCAPACIDAD, TIPOAFILIADO, GRUPOATESPECIAL, CABEZADEFAMILIA, ASOCIADO, TIENEOBS, CAMPOUSUARIO1, FECHAUVISITA, CONSANGUINIDAD, IDADMINISTRADORA, IDCAUSAL,  FECHACAUSAL, CLASIFPC, NIVELSOCIOEC, IDPLAN, FECHAAFILIACION, NUMCARNET, CIUDADDOC, IDEMPLEADOR, SEMANASCOT, CARNETIZADO, FECHACARNET, CONSCERTIFICADO, CIUDADNAC, IDOCUPACION,  NACIONALIDAD, CELULAR, DIRECCIONLAB, TELEFONOLAB, CNSAFIAA, SISBENNUMFICHA, SISBENFECHAFICHA, SISBENPUNTAJE, SISBENNUCLEOFAM, SISBENGRUPOB, IDCONTRATO, IDBARRIO, CLASEAFILIACIONARS,  FORMULARIO, EMAIL, NORADICACION, FECHARADICACION, IDTIPOAFILIACION, IDCLASEAFILIACION, V_FORMULARIO, SISBENNIVEL, CNSXCPA, FESTADO, OKBD, USUARIOBD, NACIMIENTO, ITFC, CNSITFC,  TIPOSUBSIDIO, COBERTURA_SALUD, TIPOAFILIADO2, IDAFI_TITULAR, ES_NN, IDESPECIAL, MTRIAGE, FTRIAGE, GRUPOPOB, IDSEDETRIAGE, F_ACTUALIZA, PRIORIDAD, URG_NOMBRE, URG_TELE, URG_DIR,  URG_VINCULO, RAIPOSITIVO, RAIFECHA, RAIUSU, USUARIOATIENDE, OBSERVACION, PORTABILIDAD, FIPORT, FFPORT, CORREGIMIENTO, IDFOTO, IDBARRIO_L, CIUDAD_L, CORREGIMIENTO_L, DIR_PPAL, LAT_DIR,  LNG_DIR, LAT_DIR_L, LNG_DIR_L, CLAVE, PIN, PROCEDENCIA, FECHACTIVACION, REFDIRPRINC, REFDIRLAB, PLANSALUD, USUPRORROGA, FECHAPRORROGA, CLASEPRORROGA, CRONICO, IDPAIS, RUC, IDMEMBRESIA,  FVMEMBRECIA, CONTRATANTE, DEPA, PRODUCTO, IDMEDCABECERA, FECHAFALLECE, CATEGORIA, PREFIJO_CELULAR, PREFIJO_TELEFONORES, TIPOUSUARIO
FROM #D

SELECT * FROM KCOC.DBO.AFI WHERE IDAFILIADO='0200001593'
SELECT * FROM #D WHERE IDAFILIADO='0200001593'

INSERT INTO KCOC.DBO.CIU
SELECT * FROM CIU WHERE NOT EXISTS(SELECT * FROM KCOC.DBO.CIU X WHERE CIU.CIUDAD=X.CIUDAD )

INSERT INTO KCOC.DBO.DEP
SELECT * FROM DEP WHERE NOT EXISTS(SELECT * FROM KCOC.DBO.DEP X WHERE DEP.DPTO=X.DPTO )

INSERT INTO KCOC.DBO.PAIS
SELECT * FROM PAIS WHERE NOT EXISTS(SELECT * FROM KCOC.DBO.PAIS X WHERE PAIS.IDPAIS=X.IDPAIS )
SELECT * FROM #C
UPDATE #A SET IDAFILIADO=#D.IDAFILIADO
FROM #A INNER JOIN #D ON #A.IDAFILIADO COLLATE SQL_Latin1_General_CP1_CI_AS =#D.IDAFILIADOANT

ALTER TABLE #A ADD CONSECTUVIOA VARCHAR(20)
UPDATE #A SET CONSECTUVIOA=CONSECUTIVO

UPDATE #A SET CONSECUTIVO='03'+RIGHT(CONSECUTIVO,LEN(CONSECUTIVO)-2)

UPDATE #A SET IDAFILIADO=#C.IDAFILIADO
FROM #A INNER JOIN #C ON #A.IDAFILIADO COLLATE SQL_Latin1_General_CP1_CI_AS =#C.IDAFILIADOANT

SELECT DBO.FNK_COLUMNAS_TABLAS('CIT')

INSERT INTO KCOC.DBO.CIT(CONSECUTIVO, FECHASOL, FECHA, FECHAATENCION, IDAFILIADO, NUMCARNET, TIPOCITA, TIPOSOLICITUD, IDSERVICIO, IDSERVICIOPROC, ATENCION, PVEZ, IDCONTRATANTE, IDSEDE, IDMEDICO, IDPLAN, URGENCIA,  VALORTOTAL, VALORCOPAGO, VALOREXEDENTE, VALORTOTALCOS, VALORCOPAGOCOSTO, IMPRESO, CUMPLIDA, IDPESPECIAL, IDESTADOE, ESTADO, CAUSALBLOQUEO, GENEROCAJA, IDSEDEATENCION, TELEFONOAVISO,  IDCAUSAL, DISPONIBILIDAD, SPD, NORECIBOCAJA, CLASEORDEN, USUARIO, NOADMISION, GENPRESTACION, FINCONSULTA, CODCAJA, FECHALLEGA, USUARIOLLEGA, OBSERVACIONES, NOAUTORIZACION,  IDSEDEORIGEN, IDIPSSOLICITA, IDMEDICOSOLICITA, AUTORIZADOPOR, FECHAAUTORIZACION, CNSAFIAA, TIPOCOPAGO, PROCEDENCIA, IDAREAH, IDAREA, CCOSTO, SUBCCOSTO, NIVELATENCION, FACTURADA,  N_FACTURA, CNSFCT, VFACTURAS, FACTURABLE, DESCUENTO, TIPODTO, MARCAFAC, IDIPS, CLASECONTRATO, ENPAQUETE, IDCIRUGIA, CNSFACT, SOAT, COPAGOPROPIO, CNSHACTRAN, ALTOCOSTO, IDDX, IDEMEDICA,  IDTERCEROCA, FINALIDAD, TIPOCAJA, CONSECUTIVOHCA, AQUIENCOBRO, VALORPROV, CODUNG, CODPRG, NOCITA, REASIGNADA, IDCONTRATO, ITFC, CNSITFC, SYS_COMPUTERNAME, NOCOBRAR, CCONTRATANTE,  CONTABILIZADA, NROCOMPROBANTE, MARCACONT, QXCONSECUTIVO, FECHACIRUGIA, FECHAREASIG, USUARIOREASIG, CODCUPS, IDPLAN_AFI, IDTERCERO_AFI, NOMBREACOMPA, TELEFONOACOMPA, PARENTESCOACOMPA,  NOMBRERESPO, TELEFONORESPO, PARENTESCORESPO, USUARIONOFACTURABLE, FECHA_NOFAC, PVEZANO, F_REQUERIDA, RIESGO, DURACION, MVARIAS, NROCITAS, CNSORIGINAL, PREGUNTAPOR, MPLAN,  IDPLANDISP, WEB, DIRECCION, CIUDAD, CORREGIMIENTO, LAT_DIR, LNG_DIR, IDBARRIO, MODALIDAD, TIPOAFILIADO, IDAUTSE, COVID, USUATENCION, USURESPONSABLE, USUGENAGENDA, FGENERACION,  IDKPAGE, COMERCIAL, HORADESDE, HORAHASTA, RESULTADOLLAMADA, USUPREANALITICA, FECHAPREANALITICA, FECHAENVIOLAB, ESTADOPREANALITICA, USUNOPROCESA, FECHANOPROCESA, RAZONNOPROCESA, ESPROGRAMAS,  URLVIDEOLLAMADA, CANTIDADC, IDFIRMAPTE, IDFIRMARESP, MODELOS, RCAMBIO, CONFIRMADA, ENUSO, USUARIOENUSO, NOPROGRAMACION, CITAENSEDE, CONDUCTOR, RAZONMEDDIF, SMSE, SMSES,  SMSER, NOASISTIO_IDCAUSAL, NOASISTIO_OBSERVACION, FECHACONFIRMA, USUCONFIRMA, EXTRA, TIME_EXTRA, IDAUTSES, RES_ONCO, REQ_AUTORIZACION, TIENE_LAB, OBS_CONFIRMADO, CNSHCA_CITACONTROL,  FIRMA_PACIENTE, FIRMA_ACUDIENTE, CONSECUTIVOMAGP, MARCA, NFACTURA, COPA_VAR_PORC, TIPO_DESC_FAR, COPA_VAR_EXA, TIPO_DESC_EXA, COPA_VAR_APOYO, TIPO_DESC_APOYO, COPA_VAR_INTERC,  TIPO_DESC_INTERC, COPAGO_FI_CON, COPAGO_FI_FAR, COPAGO_VA_FAR, COPAGO_FI_EXA, COPAGO_VA_EXA, EMBARAZADA, IDMAD, TVALORACION, CNSPAQ)
SELECT CONSECUTIVO, FECHASOL, FECHA, FECHAATENCION, IDAFILIADO, NUMCARNET, TIPOCITA, TIPOSOLICITUD, IDSERVICIO, IDSERVICIOPROC, ATENCION, PVEZ, IDCONTRATANTE, IDSEDE, IDMEDICO, IDPLAN, URGENCIA,  VALORTOTAL, VALORCOPAGO, VALOREXEDENTE, VALORTOTALCOS, VALORCOPAGOCOSTO, IMPRESO, CUMPLIDA, IDPESPECIAL, IDESTADOE, ESTADO, CAUSALBLOQUEO, GENEROCAJA, IDSEDEATENCION, TELEFONOAVISO,  IDCAUSAL, DISPONIBILIDAD, SPD, NORECIBOCAJA, CLASEORDEN, USUARIO, NOADMISION, GENPRESTACION, FINCONSULTA, CODCAJA, FECHALLEGA, USUARIOLLEGA, OBSERVACIONES, NOAUTORIZACION,  IDSEDEORIGEN, IDIPSSOLICITA, IDMEDICOSOLICITA, AUTORIZADOPOR, FECHAAUTORIZACION, CNSAFIAA, TIPOCOPAGO, PROCEDENCIA, IDAREAH, IDAREA, CCOSTO, SUBCCOSTO, NIVELATENCION, FACTURADA,  N_FACTURA, CNSFCT, VFACTURAS, FACTURABLE, DESCUENTO, TIPODTO, MARCAFAC, IDIPS, CLASECONTRATO, ENPAQUETE, IDCIRUGIA, CNSFACT, SOAT, COPAGOPROPIO, CNSHACTRAN, ALTOCOSTO, IDDX, IDEMEDICA,  IDTERCEROCA, FINALIDAD, TIPOCAJA, CONSECUTIVOHCA, AQUIENCOBRO, VALORPROV, CODUNG, CODPRG, NOCITA, REASIGNADA, IDCONTRATO, ITFC, CNSITFC, SYS_COMPUTERNAME, NOCOBRAR, CCONTRATANTE,  CONTABILIZADA, NROCOMPROBANTE, MARCACONT, QXCONSECUTIVO, FECHACIRUGIA, FECHAREASIG, USUARIOREASIG, CODCUPS, IDPLAN_AFI, IDTERCERO_AFI, NOMBREACOMPA, TELEFONOACOMPA, PARENTESCOACOMPA,  NOMBRERESPO, TELEFONORESPO, PARENTESCORESPO, USUARIONOFACTURABLE, FECHA_NOFAC, PVEZANO, F_REQUERIDA, RIESGO, DURACION, MVARIAS, NROCITAS, CNSORIGINAL, PREGUNTAPOR, MPLAN,  IDPLANDISP, WEB, DIRECCION, CIUDAD, CORREGIMIENTO, LAT_DIR, LNG_DIR, IDBARRIO, MODALIDAD, TIPOAFILIADO, IDAUTSE, COVID, USUATENCION, USURESPONSABLE, USUGENAGENDA, FGENERACION,  IDKPAGE, COMERCIAL, HORADESDE, HORAHASTA, RESULTADOLLAMADA, USUPREANALITICA, FECHAPREANALITICA, FECHAENVIOLAB, ESTADOPREANALITICA, USUNOPROCESA, FECHANOPROCESA, RAZONNOPROCESA, ESPROGRAMAS,  URLVIDEOLLAMADA, CANTIDADC, IDFIRMAPTE, IDFIRMARESP, MODELOS, RCAMBIO, CONFIRMADA, ENUSO, USUARIOENUSO, NOPROGRAMACION, CITAENSEDE, CONDUCTOR, RAZONMEDDIF, SMSE, SMSES,  SMSER, NOASISTIO_IDCAUSAL, NOASISTIO_OBSERVACION, FECHACONFIRMA, USUCONFIRMA, EXTRA, TIME_EXTRA, IDAUTSES, RES_ONCO, REQ_AUTORIZACION, TIENE_LAB, OBS_CONFIRMADO, CNSHCA_CITACONTROL,  FIRMA_PACIENTE, FIRMA_ACUDIENTE, CONSECUTIVOMAGP, MARCA, NFACTURA, COPA_VAR_PORC, TIPO_DESC_FAR, COPA_VAR_EXA, TIPO_DESC_EXA, COPA_VAR_APOYO, TIPO_DESC_APOYO, COPA_VAR_INTERC,  TIPO_DESC_INTERC, COPAGO_FI_CON, COPAGO_FI_FAR, COPAGO_VA_FAR, COPAGO_FI_EXA, COPAGO_VA_EXA, EMBARAZADA, IDMAD, TVALORACION, CNSPAQ
FROM  #A
WHERE IDAFILIADO IS  NULL
AND NOT EXISTS(SELECT * FROM KCOC.DBO.CIT X WHERE #A.IDMEDICO=X.IDMEDICO)

SELECT * FROM AFI WHERE 

SELECT  * FROM CIT WHERE IDMEDICO='77012188' AND CONVERT(DATE,FECHA)='05/04/2025'


SELECT * FROM #A

SELECT * FROM MED WHERE IDMEDICO='77012188'
DROP TABLE #G
SELECT HCA.* INTO  #G FROM HCA INNER JOIN #A ON HCA.CONSECUTIVOCIT COLLATE SQL_Latin1_General_CP1_CI_AS =#A.CONSECTUVIOA

ALTER TABLE #G ADD CONSECUTIVOA VARCHAR(20)

UPDATE #G SET CONSECUTIVOA=CONSECUTIVO

SELECT  * FROM #G

UPDATE #G SET CONSECUTIVO='ON03'+RIGHT(CONSECUTIVO,LEN(CONSECUTIVO)-4) WHERE  LEFT(CONSECUTIVO,2)='ON'

UPDATE #G SET 

SELECT DISTINCT CONSECUTIVOMAGP INTO #H FROM #A


UPDATE #G SET IDAFILIADO=#C.IDAFILIADO
FROM #G INNER JOIN #C ON #G.IDAFILIADO COLLATE SQL_Latin1_General_CP1_CI_AS =#C.IDAFILIADOANT

SELECT HCAD.* INTO #J FROM HCAD INNER JOIN #G ON HCAD.CONSECUTIVO COLLATE SQL_Latin1_General_CP1_CI_AS=#G.CONSECUTIVOA
SELECT HCADL.* INTO #K FROM HCADL INNER JOIN #G ON HCADL.CONSECUTIVO COLLATE SQL_Latin1_General_CP1_CI_AS=#G.CONSECUTIVOA
SELECT HCATD.* INTO #L FROM HCATD INNER JOIN #G ON HCATD.CONSECUTIVO COLLATE SQL_Latin1_General_CP1_CI_AS=#G.CONSECUTIVOA

UPDATE #J SET CONSECUTIVO=#G.CONSECUTIVO
FROM #J INNER JOIN #G ON #J.CONSECUTIVO=#G.CONSECUTIVOA COLLATE SQL_Latin1_General_CP1_CI_AS

UPDATE #K SET CONSECUTIVO=#G.CONSECUTIVO
FROM #K INNER JOIN #G ON #K.CONSECUTIVO=#G.CONSECUTIVOA COLLATE SQL_Latin1_General_CP1_CI_AS

UPDATE #L SET CONSECUTIVO=#G.CONSECUTIVO
FROM #L INNER JOIN #G ON #L.CONSECUTIVO=#G.CONSECUTIVOA COLLATE SQL_Latin1_General_CP1_CI_AS

SELECT * INTO #I FROM MAGP WHERE CONSECUTIVO IN(SELECT * FROM #H)

ALTER TABLE #I ADD CONSECUTIVOA VARCHAR(20)

UPDATE #I SET CONSECUTIVOA=CONSECUTIVO

UPDATE #I SET CONSECUTIVO='03'+RIGHT(CONSECUTIVO,LEN(CONSECUTIVO)-2)

SELECT DBO.FNK_COLUMNAS_TABLAS('MAGP')

INSERT INTO KCOC.DBO.MAGP(CONSECUTIVO, IDMEDICO, FECHAINICIAL, FECHAFINAL, USARMODELO, INTERVALO, DISPONIBILIDAD, MPLAN, IDPLAN, FESTIVOS, GENERADA, BORRADA, TIPO, NOCITAS, USUARIO, SYS_COMPUTERNAME, FECHA,  MODELOS, IDSEDE, RCAMBIO, VIRTUAL, WEB, ESPROGRAMAS)
SELECT CONSECUTIVO, IDMEDICO, FECHAINICIAL, FECHAFINAL, USARMODELO, INTERVALO, DISPONIBILIDAD, MPLAN, IDPLAN, FESTIVOS, GENERADA, BORRADA, TIPO, NOCITAS, USUARIO, SYS_COMPUTERNAME, FECHA,  MODELOS, IDSEDE, RCAMBIO, VIRTUAL, WEB, ESPROGRAMAS
FROM #I

SELECT DBO.FNK_COLUMNAS_TABLAS('HCATD')

INSERT INTO KCOC.DBO.HCA(CONSECUTIVO, CLASEPLANTILLA, FECHA, IDMEDICO, IDAFILIADO, NOADMISION, IDDX, TIPODX, IMPRESO, EDAD, FINALIDAD, DX1, DX2, DX3, IDMEDICODILIGENCIA, IDDXEG, N_HISTORIA, PROCEDENCIA, REVISAESP,  IDMEDICOESP, PIDEDX, PIDESV, TAS, TAD, FC, FR, TEMP, TALLA, PULSO, PESO, GLASGOW, TIPOGLASGOW, HIDRATACION, ALTA, CLASE, ITEMHADM, IDAREA, ANULADA, USUARIOANU, FECHA_ANU,  OBSERVAANU, AMBITO, MED_ESPEC, CAUSA_EXT, SINCRONIZADO, IDPLAN, CCOSTO, ENEPICRISIS, CERRADA, EVOLUCION, ITEMRED, PLANDEMANEJO, RESUMEN, EVOLSUB, ANALISIS, ESTANCIA, RESPARACLINI,  JUSTESTANCIA, TAM, SOAT, BOLO, CONSECUTIVO_RED_ORI, ITEMRED_RED_ORI, DIURESIS, CNSNESIGVIT_SV, CNSNESIGVIT_GC, CNSNESIGVIT_GA, TIPOSV, PLANDEMANEJOMED, CNSNESIGVIT_GV, CNSNESIGVIT_PV,  CNSNESIGVIT_IO, TIPOPM, COPIADA, CONSECUTIVOCOPIA, REVISADO, FECHAREV, USUARIOREV, ESTADOCIERRE, CONSECUTIVOCIERRE, CREADAEN, SOFA, NOCOPIAOM, RIESGO, DX4, USUARIO, CODAZUL,  IDAFILIADO_RN, CNSWEB, CONSECUTIVOP, CONSECUTIVOCIT, COVID, CHECK1, CHECK2, CHECK3, FECHAATIENDE, NECPAL, N_S1, N_S2, N_S3, N_S4, N_S5, N_S6, ESTADOAUD, IDMEDICO_AUD, FECHA_AUD,  CODIGO_AUD, OBSERVACIONAUD, NOTA_ACLARA, CNSHCA_NOTA, GRUPAL, PROTOCOLO, FENVIO_WHATSAPP, FENVIO_EMAIL, TIPOLLAMADA, MOTIVOLLAMADA, IDEMEDICA, IDEMEDICAESP, FECHA_REGISTRO, FECHA_DILIGENCIA )
SELECT CONSECUTIVO, CLASEPLANTILLA, FECHA, IDMEDICO, IDAFILIADO, NOADMISION, IDDX, TIPODX, IMPRESO, EDAD, FINALIDAD, DX1, DX2, DX3, IDMEDICODILIGENCIA, IDDXEG, N_HISTORIA, PROCEDENCIA, REVISAESP,  IDMEDICOESP, PIDEDX, PIDESV, TAS, TAD, FC, FR, TEMP, TALLA, PULSO, PESO, GLASGOW, TIPOGLASGOW, HIDRATACION, ALTA, CLASE, ITEMHADM, IDAREA, ANULADA, USUARIOANU, FECHA_ANU,  OBSERVAANU, AMBITO, MED_ESPEC, CAUSA_EXT, SINCRONIZADO, IDPLAN, CCOSTO, ENEPICRISIS, CERRADA, EVOLUCION, ITEMRED, PLANDEMANEJO, RESUMEN, EVOLSUB, ANALISIS, ESTANCIA, RESPARACLINI,  JUSTESTANCIA, TAM, SOAT, BOLO, CONSECUTIVO_RED_ORI, ITEMRED_RED_ORI, DIURESIS, CNSNESIGVIT_SV, CNSNESIGVIT_GC, CNSNESIGVIT_GA, TIPOSV, PLANDEMANEJOMED, CNSNESIGVIT_GV, CNSNESIGVIT_PV,  CNSNESIGVIT_IO, TIPOPM, COPIADA, CONSECUTIVOCOPIA, REVISADO, FECHAREV, USUARIOREV, ESTADOCIERRE, CONSECUTIVOCIERRE, CREADAEN, SOFA, NOCOPIAOM, RIESGO, DX4, USUARIO, CODAZUL,  IDAFILIADO_RN, CNSWEB, CONSECUTIVOP, CONSECUTIVOCIT, COVID, CHECK1, CHECK2, CHECK3, FECHAATIENDE, NECPAL, N_S1, N_S2, N_S3, N_S4, N_S5, N_S6, ESTADOAUD, IDMEDICO_AUD, FECHA_AUD,  CODIGO_AUD, OBSERVACIONAUD, NOTA_ACLARA, CNSHCA_NOTA, GRUPAL, PROTOCOLO, FENVIO_WHATSAPP, FENVIO_EMAIL, TIPOLLAMADA, MOTIVOLLAMADA, IDEMEDICA, IDEMEDICAESP, FECHA_REGISTRO, FECHA_DILIGENCIA 
FROM #G

INSERT INTO KCOC.DBO.HCAD(CONSECUTIVO, CLASEPLANTILLA, CAMPO, SECUENCIA, NADA, NORMAL, ANORMAL, DETALLAR, NOTAS, TIPOCAMPO, ALFANUMERICO, FECHA, MEMO, OBS, LISTA, ENEPICRISIS, SINCRONIZADO, MINIMO, MAXIMO, PROMEDIO,  VALORGRAFICA, NUMERICO, IDIMAGEN, ANCHOIMG, ALTOIMG, ESCALAX, ESCALAY)
SELECT CONSECUTIVO, CLASEPLANTILLA, CAMPO, SECUENCIA, NADA, NORMAL, ANORMAL, DETALLAR, NOTAS, TIPOCAMPO, ALFANUMERICO, FECHA, MEMO, OBS, LISTA, ENEPICRISIS, SINCRONIZADO, MINIMO, MAXIMO, PROMEDIO,  VALORGRAFICA, NUMERICO, IDIMAGEN, ANCHOIMG, ALTOIMG, ESCALAX, ESCALAY
FROM #J

INSERT INTO KCOC.DBO.HCADL(CONSECUTIVO, SECUENCIA, ITEM, VALORLISTA, CHECKM, DESCRIPCION, SINCRONIZADO, ID, XPOS, YPOS, COLOR, FORMA, IMGSERIE, TITULOMAPA, TAMANO)
SELECT CONSECUTIVO, SECUENCIA, ITEM, VALORLISTA, CHECKM, DESCRIPCION, SINCRONIZADO, ID, XPOS, YPOS, COLOR, FORMA, IMGSERIE, TITULOMAPA, TAMANO
FROM #K

INSERT INTO KCOC.DBO.HCATD (CONSECUTIVO, ITEMRED, CODOM, IDSERVICIO, CANTIDAD, IDTIPOCONC, VIA, OBSERVACION, CLASE, ENCARGOS, NOPRESTACION, APLICADA, CONSECUTIVONE, NOITEM, NOINGRESO, NORDEN, FRECUENCIA, DURACION,  TIPO, AVISADOENF, FECHAGA, IDPROVEEDOR, CANTIDADNOCC, CNSHJNOPOS, DESCRIPTIVA, DESTINO, OBSDESCRIPTIVA, CANTIDADINV, IDPERFIL, COPIADO, CANTIDADBOLO, PRIMER, CANTIDADORI, FRECUENCIAORI,  DURACIONORI, DOSISUNICA, FECHAINI, IDSERVICIOMEZCLA, QMEZCLA, QIMPSERVICIO, QIMPMEZCLA, DURACIONIMP, RAZONNEC, ORDEN, HORAAM, QAM, HORAPM, QPM, HORASMAX, FECHAMAX, GOTEO,  GENHORARIO, LUNES, MARTES, MIERCOLES, JUEVES, VIERNES, SABADO, DOMINGO, FFINALDOSIS, TIPOSOLBS, BSCAPACIDAD, IDBODEGA, CODPAQUETE, VERIFICA, LATERALIDAD, TIPOFRECUENCIA, DOSIF,  ESTADOCALL, FECHACALL, USUARIO, NOADMISION, OBS_CALL, IDCAUSAL, AUTORIZADO, HBALINI, RUTA, TOTALUNIDADES, PRESCRIPCION, TIPODURACION, IDDX, ITEM_DXUNIRS, EFECTOS, TOTAL_CONTROLADOS,  MOB_ESTADO, IDIACTMOV, PROTOCOLO, CANTDIAS, FECHAFIN, ENAYUNO)
SELECT CONSECUTIVO, ITEMRED, CODOM, IDSERVICIO, CANTIDAD, IDTIPOCONC, VIA, OBSERVACION, CLASE, ENCARGOS, NOPRESTACION, APLICADA, CONSECUTIVONE, NOITEM, NOINGRESO, NORDEN, FRECUENCIA, DURACION,  TIPO, AVISADOENF, FECHAGA, IDPROVEEDOR, CANTIDADNOCC, CNSHJNOPOS, DESCRIPTIVA, DESTINO, OBSDESCRIPTIVA, CANTIDADINV, IDPERFIL, COPIADO, CANTIDADBOLO, PRIMER, CANTIDADORI, FRECUENCIAORI,  DURACIONORI, DOSISUNICA, FECHAINI, IDSERVICIOMEZCLA, QMEZCLA, QIMPSERVICIO, QIMPMEZCLA, DURACIONIMP, RAZONNEC, ORDEN, HORAAM, QAM, HORAPM, QPM, HORASMAX, FECHAMAX, GOTEO,  GENHORARIO, LUNES, MARTES, MIERCOLES, JUEVES, VIERNES, SABADO, DOMINGO, FFINALDOSIS, TIPOSOLBS, BSCAPACIDAD, IDBODEGA, CODPAQUETE, VERIFICA, LATERALIDAD, TIPOFRECUENCIA, DOSIF,  ESTADOCALL, FECHACALL, USUARIO, NOADMISION, OBS_CALL, IDCAUSAL, AUTORIZADO, HBALINI, RUTA, TOTALUNIDADES, PRESCRIPCION, TIPODURACION, IDDX, ITEM_DXUNIRS, EFECTOS, TOTAL_CONTROLADOS,  MOB_ESTADO, IDIACTMOV, PROTOCOLO, CANTDIAS, FECHAFIN, ENAYUNO
FROM #L