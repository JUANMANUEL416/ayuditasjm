DECLARE 
@CNSFNOT           VARCHAR(16),
@CLASE             VARCHAR(2),
@USUARIO             VARCHAR(12),
@SYS_COMPUTERNAME    VARCHAR(254),
@COMPANIA            VARCHAR(2),
@SEDE                VARCHAR(5),
@NROCOMPROBANTE      VARCHAR(20) 
 


   DECLARE MCP_RECONSTRUYE CURSOR FOR
   SELECT REFERENCIA1,REFERENCIA2,USUARIO,'SOPORTE',COMPANIA,IDSEDE,NROCOMPROBANTE  FROM MCPE WHERE COMPROBANTE='12' AND PROCEDENCIA='NOTDBCR'
   GROUP BY REFERENCIA1,REFERENCIA2,USUARIO,COMPANIA,IDSEDE,NROCOMPROBANTE
   OPEN MCP_RECONSTRUYE    
   FETCH NEXT FROM MCP_RECONSTRUYE    
   INTO @CNSFNOT,@CLASE,@USUARIO,@SYS_COMPUTERNAME,@COMPANIA,@SEDE,@NROCOMPROBANTE
   WHILE @@FETCH_STATUS = 0    
   BEGIN
       PRINT 'EMPEZANDO....'+@CNSFNOT
       EXEC DBO.SPK_NC_CONTAB_FNOT @CNSFNOT,@CLASE,@USUARIO,@SYS_COMPUTERNAME,@COMPANIA,@SEDE,@NROCOMPROBANTE
    
   FETCH NEXT FROM MCP_RECONSTRUYE    
   INTO @CNSFNOT,@CLASE,@USUARIO,@SYS_COMPUTERNAME,@COMPANIA,@SEDE,@NROCOMPROBANTE
   END
   CLOSE MCP_RECONSTRUYE
   DEALLOCATE MCP_RECONSTRUYE
   