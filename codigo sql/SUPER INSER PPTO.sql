	DECLARE @COMPANIA VARCHAR(4)
	DECLARE @CONSECUTIVO VARCHAR(4)
	DECLARE @RECO VARCHAR(20)
	DECLARE @OBJETIVO VARCHAR(1020)
	DECLARE @VALOR  DECIMAL(14,2)
	DECLARE @CCOSTO VARCHAR(10)
	DECLARE @RUBRO  VARCHAR(20)
	DECLARE @CONTA  INT 
	DECLARE @CNSPAGO VARCHAR(20)
	
	SET @CONTA=6824
	
   DECLARE PG_CURSOR CURSOR FOR   
   SELECT A.COMPANIA,A.CONSECUTIVO,A.RECO,A.OBJETIVO,B.VALOR,CCOSTO,B.RUBRO
   FROM PTRECO A INNER JOIN PTRECOD B ON A.RECO=B.RECO
   WHERE A.CONSECUTIVO='2013' AND B.RUBRO='1110111031001'
   AND B.RECO NOT IN(SELECT RECO FROM PTRECA WHERE CONSECUTIVO='2013')      
   OPEN PG_CURSOR    
   FETCH NEXT FROM PG_CURSOR    
   INTO @COMPANIA,@CONSECUTIVO,@RECO,@OBJETIVO,@VALOR,@CCOSTO,@RUBRO
   WHILE @@FETCH_STATUS = 0    
   BEGIN 
	  SELECT @CONTA=@CONTA+1
	  SELECT @CNSPAGO='01' + REPLACE(SPACE(8 - LEN(@CONTA))+LTRIM(RTRIM(@CONTA)),SPACE(1),0)
	  
	  PRINT 'Consecutivo REco =::::  '+@RECO
	  
	  INSERT INTO PTRECA (COMPANIA,CONSECUTIVO,RECO,CNSPAGO,OBSERVACION,VALOR,FECHA,ORIGENPAGO,ITEM_BMOV,ESTADO,CCOSTO,TIPO)
	  SELECT @COMPANIA,@CONSECUTIVO,@RECO,@CNSPAGO,@OBJETIVO,@VALOR,'20131231','Banco',0,'NoConfirmado',@CCOSTO,'Suma'
	  
	  INSERT INTO PTRECAD(COMPANIA,CONSECUTIVO,RECO,CNSPAGO,CLASE,RUBRO,OBSERVACION,VALOR) 
	  SELECT @COMPANIA,@CONSECUTIVO,@RECO,@CNSPAGO,'Ingreso',@RUBRO,@OBJETIVO,@VALOR
	  
      UPDATE PTPTO SET CONTADOR_RRR=@CONTA WHERE CONSECUTIVO='2013'
      
   FETCH NEXT FROM PG_CURSOR    
   INTO @COMPANIA,@CONSECUTIVO,@RECO,@OBJETIVO,@VALOR,@CCOSTO,@RUBRO
   END
   CLOSE PG_CURSOR
   DEALLOCATE PG_CURSOR