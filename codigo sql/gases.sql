
SELECT * FROM  MPL WHERE DESCPLANTILLA LIKE'%nitri%'

SELECT * FROM HCAD WHERE CLASEPLANTILLA='GMOXINI' AND CONSECUTIVO='ON00000722'


SELECT  A.NOADMISION,A.IDAFILIADO,(B.PAPELLIDO+' '+B.SAPELLIDO+' '+B.PNOMBRE+' '+B.SNOMBRE)NOMBRE_PACIENTE,
B.TIPO_DOC,B.SEXO,
DBO.FNK_FECHA((SELECT TOP 1 FECHA FROM HCA WHERE NOADMISION=A.NOADMISION AND CLASEPLANTILLA='GMOXIGE'))FECHA,
LEFT(DBO.FNK_HORAS((SELECT TOP 1 FECHA FROM HCA WHERE NOADMISION=A.NOADMISION AND CLASEPLANTILLA='GMOXIGE')),5)HORA
FROM HADM A INNER JOIN AFI B ON A.IDAFILIADO=B.IDAFILIADO
WHERE NOADMISION='0100000001'

SELECT  A.NOADMISION,A.IDAFILIADO,(B.PAPELLIDO+' '+B.SAPELLIDO+' '+B.PNOMBRE+' '+B.SNOMBRE)NOMBRE_PACIENTE,
B.TIPO_DOC,B.SEXO,
DBO.FNK_FECHA((SELECT TOP 1 FECHA FROM HCA WHERE NOADMISION=A.NOADMISION AND CLASEPLANTILLA='GMOXIGE'))FECHA,
LEFT(DBO.FNK_HORAS((SELECT TOP 1 FECHA FROM HCA WHERE NOADMISION=A.NOADMISION AND CLASEPLANTILLA='GMOXIGE')),5)HORA
FROM HADM A INNER JOIN AFI B ON A.IDAFILIADO=B.IDAFILIADO
WHERE NOADMISION='0100000001'

SELECT A.CONSECUTIVO,C.NOMBRE,A.FECHA,
(SELECT dbo.FNK_FECHA(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='10' AND CLASEPLANTILLA='GMOXIGE')FECHAINI,
(SELECT dbo.FNK_HORAS(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='10' AND CLASEPLANTILLA='GMOXIGE')HORAINI,
(SELECT dbo.FNK_FECHA(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='20' AND CLASEPLANTILLA='GMOXIGE')FECHAFIN,
(SELECT dbo.FNK_HORAS(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='20' AND CLASEPLANTILLA='GMOXIGE')HORAFIN,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='30' AND CLASEPLANTILLA='GMOXIGE')MODO,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='40' AND CLASEPLANTILLA='GMOXIGE')FLUJO,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='50' AND CLASEPLANTILLA='GMOXIGE')FIO2,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='60' AND CLASEPLANTILLA='GMOXIGE')TLITROS,
LEFT((SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='70' AND CLASEPLANTILLA='GMOXIGE'),2)THORAS
FROM HCA A INNER JOIN HCAD B ON A.CONSECUTIVO=B.CONSECUTIVO
		   INNER JOIN MED  C ON A.IDMEDICO=C.IDMEDICO
WHERE A.NOADMISION='0100000001' AND A.CLASEPLANTILLA='GMOXIGE' 
GROUP BY  A.CONSECUTIVO,C.NOMBRE


SELECT * FROM HCAD WHERE CLASEPLANTILLA='GMOXIGE' AND CONSECUTIVO='ON00000002'


SELECT A.CONSECUTIVO,C.NOMBRE,A.FECHA,
(SELECT dbo.FNK_FECHA(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='10' AND CLASEPLANTILLA='GMOXIGE')FECHAINI,
(SELECT dbo.FNK_HORAS(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='10' AND CLASEPLANTILLA='GMOXIGE')HORAINI,
(SELECT dbo.FNK_FECHA(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='20' AND CLASEPLANTILLA='GMOXIGE')FECHAFIN,
(SELECT dbo.FNK_HORAS(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='20' AND CLASEPLANTILLA='GMOXIGE')HORAFIN,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='30' AND CLASEPLANTILLA='GMOXIGE')MODO,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='40' AND CLASEPLANTILLA='GMOXIGE')FLUJO,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='50' AND CLASEPLANTILLA='GMOXIGE')FIO2,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='60' AND CLASEPLANTILLA='GMOXIGE')TLITROS,
LEFT((SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='70' AND CLASEPLANTILLA='GMOXIGE'),2)THORAS
FROM HCA A INNER JOIN HCAD B ON A.CONSECUTIVO=B.CONSECUTIVO
		   INNER JOIN MED  C ON A.IDMEDICO=C.IDMEDICO
WHERE A.NOADMISION LIKE '01%10' AND A.CLASEPLANTILLA='GMOXIGE' 
GROUP BY  A.CONSECUTIVO,C.NOMBRE,A.FECHA
ORDER BY A.FECHA


SELECT * FROM HCAD WHERE CLASEPLANTILLA='GMOXINI' AND CONSECUTIVO='ON00000722'
SELECT * FROM HCA WHERE CLASEPLANTILLA='GMOXINI' AND CONSECUTIVO='ON00000722'

SELECT  A.NOADMISION,A.IDAFILIADO,(B.PAPELLIDO+' '+B.SAPELLIDO+' '+B.PNOMBRE+' '+B.SNOMBRE)NOMBRE_PACIENTE,
B.TIPO_DOC,B.SEXO,CASE WHEN DATEDIFF(DAY,B.FNACIMIENTO,GETDATE())>29 THEN CASE WHEN DATEDIFF(MONTH,B.FNACIMIENTO,GETDATE())>11
THEN CAST(DATEDIFF(YEAR,B.FNACIMIENTO,GETDATE()) AS VARCHAR(3))+' '+ 'AÑOS' 
ELSE  CAST(DATEDIFF(MONTH,B.FNACIMIENTO,GETDATE())AS VARCHAR(3))+' '+ 'MESES'
END ELSE CAST(DATEDIFF(DAY,B.FNACIMIENTO,GETDATE()) AS VARCHAR(3))+' '+ 'DIAS' END EDAD,
DBO.FNK_FECHA((SELECT TOP 1 FECHA FROM HCA WHERE NOADMISION like'%$noadmision' AND CLASEPLANTILLA='GMOXINI'))FECHA,
LEFT(DBO.FNK_HORAS((SELECT TOP 1 FECHA FROM HCA WHERE NOADMISION like'%$noadmision' AND CLASEPLANTILLA='GMOXINI')),5)HORA
FROM HADM A INNER JOIN AFI B ON A.IDAFILIADO=B.IDAFILIADO
WHERE NOADMISION like'%$noadmision'

SELECT A.CONSECUTIVO,C.NOMBRE,A.FECHA,
(SELECT dbo.FNK_FECHA(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='10' AND CLASEPLANTILLA='GMOXINI')FECHAINI,
(SELECT dbo.FNK_HORAS(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='10' AND CLASEPLANTILLA='GMOXINI')HORAINI,
(SELECT dbo.FNK_FECHA(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='20' AND CLASEPLANTILLA='GMOXINI')FECHAFIN,
(SELECT dbo.FNK_HORAS(FECHA) FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='20' AND CLASEPLANTILLA='GMOXINI')HORAFIN,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='30' AND CLASEPLANTILLA='GMOXINI')CANT_BALA_PSI,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='40' AND CLASEPLANTILLA='GMOXINI')FIO2,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='50' AND CLASEPLANTILLA='GMOXINI')PPM_PTE,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='60' AND CLASEPLANTILLA='GMOXINI')THORAS,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='70' AND CLASEPLANTILLA='GMOXINI')COMPLI_ESTATICA,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='80' AND CLASEPLANTILLA='GMOXINI')INDICE_OXIG,
(SELECT ALFANUMERICO FROM HCAD WHERE CONSECUTIVO=A.CONSECUTIVO AND SECUENCIA='90' AND CLASEPLANTILLA='GMOXINI')PAFIO2
FROM HCA A INNER JOIN HCAD B ON A.CONSECUTIVO=B.CONSECUTIVO
		   INNER JOIN MED  C ON A.IDMEDICO=C.IDMEDICO
WHERE A.NOADMISION like'0100000004' AND A.CLASEPLANTILLA='GMOXINI' 
GROUP BY  A.CONSECUTIVO,C.NOMBRE,A.FECHA
ORDER BY A.FECHA

SELECT DISTINCT A.NOADMISION,(B.PAPELLIDO+' '+B.SAPELLIDO+' '+B.PNOMBRE+' '+B.SNOMBRE)NOMBRE_PACIENTE,
CASE WHEN DATEDIFF(DAY,B.FNACIMIENTO,GETDATE())>29 THEN CASE WHEN DATEDIFF(MONTH,B.FNACIMIENTO,GETDATE())>11
THEN CAST(DATEDIFF(YEAR,B.FNACIMIENTO,GETDATE()) AS VARCHAR(3))+' '+ 'AÑOS' 
ELSE  CAST(DATEDIFF(MONTH,B.FNACIMIENTO,GETDATE())AS VARCHAR(3))+' '+ 'MESES'
END ELSE CAST(DATEDIFF(DAY,B.FNACIMIENTO,GETDATE()) AS VARCHAR(3))+' '+ 'DIAS' END EDAD
FROM HCA A INNER JOIN AFI B ON A.IDAFILIADO=B.IDAFILIADO
WHERE A.CLASEPLANTILLA='GMOXINI'


SELECT DISTINCT A.NOADMISION,(B.PAPELLIDO+' '+B.SAPELLIDO+' '+B.PNOMBRE+' '+B.SNOMBRE)NOMBRE_PACIENTE,
CASE WHEN DATEDIFF(DAY,B.FNACIMIENTO,GETDATE())>29 THEN CASE WHEN DATEDIFF(MONTH,B.FNACIMIENTO,GETDATE())>11
THEN CAST(DATEDIFF(YEAR,B.FNACIMIENTO,GETDATE()) AS VARCHAR(3))+' '+ 'AÑOS' 
ELSE  CAST(DATEDIFF(MONTH,B.FNACIMIENTO,GETDATE())AS VARCHAR(3))+' '+ 'MESES'
END ELSE CAST(DATEDIFF(DAY,B.FNACIMIENTO,GETDATE()) AS VARCHAR(3))+' '+ 'DIAS' END EDAD
FROM HCA A INNER JOIN AFI B ON A.IDAFILIADO=B.IDAFILIADO
WHERE A.CLASEPLANTILLA='GMOXINI'