
CREATE PROCEDURE SPKH_PERFIL_FARMACOLOGICO(@NOADMISION VARCHAR (12))
AS
SET NOCOUNT ON

DECLARE @NUMER INT

--BORRADO TABLA

DELETE PERFAR

SET @NUMER=(SELECT DATEDIFF(DAY,FECHA,(SELECT FECHA FROM HRED WHERE ITEMRED=(SELECT MAX(ITEMRED)
FROM HRED WHERE NOADMISION=@NOADMISION) AND NOADMISION=@NOADMISION)) FROM HADM WHERE NOADMISION=@NOADMISION)

PRINT 'DIAS DE ESTANCIA'+' '+CAST(@NUMER AS VARCHAR(10))

BEGIN
IF @NUMER>=0 AND @NUMER<=10
BEGIN
PRINT 'BLOQUE 0'

INSERT INTO PERFAR(IDARTICULO,DESCRIPCION,	D00,  
	D01,	D02,	D03,	D04,	D05,	D06,	D07,	D08,	D09,  D10,TOTAL)
SELECT B.IDARTICULO,B.DESCRIPCION,SUM(B.D00)D00,SUM(B.D01)D01,SUM(B.D02)D02,SUM(B.D03)D03,SUM(B.D04)D04,SUM(B.D05)D05,
SUM(B.D06)D06,SUM(B.D07)D07,SUM(B.D08)D08,SUM(B.D09)D09,SUM(B.D10)D10,
(SUM(B.D00)+SUM(B.D01)+SUM(B.D02)+SUM(B.D03)+SUM(B.D04)+SUM(B.D05)+SUM(B.D06)+SUM(B.D07)+SUM(B.D08)+SUM(B.D09)+SUM(B.D10))TOTAL
FROM (
SELECT A.IDARTICULO,A.DESCRIPCION,
CASE DIA WHEN 0 THEN CANTIDAD ELSE 0 END D00,
CASE DIA WHEN 1 THEN CANTIDAD ELSE 0 END D01,
CASE DIA WHEN 2 THEN CANTIDAD ELSE 0 END D02,
CASE DIA WHEN 3 THEN CANTIDAD ELSE 0 END D03,
CASE DIA WHEN 4 THEN CANTIDAD ELSE 0 END D04,
CASE DIA WHEN 5 THEN CANTIDAD ELSE 0 END D05,
CASE DIA WHEN 6 THEN CANTIDAD ELSE 0 END D06,
CASE DIA WHEN 7 THEN CANTIDAD ELSE 0 END D07,
CASE DIA WHEN 8 THEN CANTIDAD ELSE 0 END D08,
CASE DIA WHEN 9 THEN CANTIDAD ELSE 0 END D09,
CASE DIA WHEN 10 THEN CANTIDAD ELSE 0 END D10
FROM (
SELECT B.IDARTICULO,C.DESCRIPCION,CONVERT(INT,B.CANTIDAD)CANTIDAD,DATEDIFF(DAY,D.FECHA,A.FECHACONF)DIA
FROM IMOV A INNER JOIN IMOVH B ON A.CNSMOV=B.CNSMOV
            INNER JOIN IART  C ON B.IDARTICULO=C.IDARTICULO
            INNER JOIN HADM  D ON A.NODOCUMENTO=D.NOADMISION
WHERE A.NODOCUMENTO=@NOADMISION AND C.IDITAR IN('01','02') AND  B.ESTADO=1) A)B
GROUP BY B.IDARTICULO,B.DESCRIPCION
ORDER BY B.DESCRIPCION

END
IF @NUMER>=11 AND @NUMER<=20
BEGIN
PRINT 'BLOQUE 1'

INSERT INTO PERFAR(	IDARTICULO,DESCRIPCION,	D00,  
	D01,	D02,	D03,	D04,	D05,	D06,	D07,	D08,	D09,  D10,
	D11,	D12,	D13,	D14,	D15,	D16,  D17,  D18,  D19,  D20,TOTAL)
SELECT B.IDARTICULO,B.DESCRIPCION,
SUM(B.D00)D00,SUM(B.D01)D01,SUM(B.D02)D02,SUM(B.D03)D03,SUM(B.D04)D04,SUM(B.D05)D05,
SUM(B.D06)D06,SUM(B.D07)D07,SUM(B.D08)D08,SUM(B.D09)D09,SUM(B.D10)D10,
SUM(B.D11)D11,SUM(B.D12)D12,SUM(B.D13)D13,SUM(B.D14)D14,SUM(B.D15)D15,
SUM(B.D16)D16,SUM(B.D17)D17,SUM(B.D18)D18,SUM(B.D19)D19,SUM(B.D20)D20,
(SUM(B.D00)+SUM(B.D01)+SUM(B.D02)+SUM(B.D03)+SUM(B.D04)+SUM(B.D05)+SUM(B.D06)+SUM(B.D07)+SUM(B.D08)+SUM(B.D09)+SUM(B.D10)+
SUM(B.D11)+SUM(B.D12)+SUM(B.D13)+SUM(B.D14)+SUM(B.D15)+SUM(B.D16)+SUM(B.D17)+SUM(B.D18)+SUM(B.D19)+SUM(B.D20)
)TOTAL

FROM (
SELECT A.IDARTICULO,A.DESCRIPCION,
CASE DIA WHEN 0 THEN CANTIDAD ELSE 0 END D00,
CASE DIA WHEN 1 THEN CANTIDAD ELSE 0 END D01,
CASE DIA WHEN 2 THEN CANTIDAD ELSE 0 END D02,
CASE DIA WHEN 3 THEN CANTIDAD ELSE 0 END D03,
CASE DIA WHEN 4 THEN CANTIDAD ELSE 0 END D04,
CASE DIA WHEN 5 THEN CANTIDAD ELSE 0 END D05,
CASE DIA WHEN 6 THEN CANTIDAD ELSE 0 END D06,
CASE DIA WHEN 7 THEN CANTIDAD ELSE 0 END D07,
CASE DIA WHEN 8 THEN CANTIDAD ELSE 0 END D08,
CASE DIA WHEN 9 THEN CANTIDAD ELSE 0 END D09,
CASE DIA WHEN 10 THEN CANTIDAD ELSE 0 END D10,
CASE DIA WHEN 11 THEN CANTIDAD ELSE 0 END D11,
CASE DIA WHEN 12 THEN CANTIDAD ELSE 0 END D12,
CASE DIA WHEN 13 THEN CANTIDAD ELSE 0 END D13,
CASE DIA WHEN 14 THEN CANTIDAD ELSE 0 END D14,
CASE DIA WHEN 15 THEN CANTIDAD ELSE 0 END D15,
CASE DIA WHEN 16 THEN CANTIDAD ELSE 0 END D16,
CASE DIA WHEN 17 THEN CANTIDAD ELSE 0 END D17,
CASE DIA WHEN 18 THEN CANTIDAD ELSE 0 END D18,
CASE DIA WHEN 19 THEN CANTIDAD ELSE 0 END D19,
CASE DIA WHEN 20 THEN CANTIDAD ELSE 0 END D20
FROM (
SELECT B.IDARTICULO,C.DESCRIPCION,CONVERT(INT,B.CANTIDAD)CANTIDAD,DATEDIFF(DAY,D.FECHA,A.FECHACONF)DIA
FROM IMOV A INNER JOIN IMOVH B ON A.CNSMOV=B.CNSMOV
            INNER JOIN IART  C ON B.IDARTICULO=C.IDARTICULO
            INNER JOIN HADM  D ON A.NODOCUMENTO=D.NOADMISION
WHERE A.NODOCUMENTO=@NOADMISION AND C.IDITAR IN('01','02') AND  B.ESTADO=1) A)B
GROUP BY B.IDARTICULO,B.DESCRIPCION


END
IF @NUMER>=21 AND @NUMER<=30
BEGIN
PRINT 'BLOQUE 2'

INSERT INTO PERFAR(	IDARTICULO,DESCRIPCION,	D00,  
	D01,	D02,	D03,	D04,	D05,	D06,	D07,	D08,	D09,  D10,
	D11,	D12,	D13,	D14,	D15,	D16,  D17,  D18,  D19,  D20,
	D21,	D22,	D23,	D24,	D25,	D26,	D27,	D28,	D29,	D30,TOTAL)


SELECT B.IDARTICULO,B.DESCRIPCION,
SUM(B.D00)D00,SUM(B.D01)D01,SUM(B.D02)D02,SUM(B.D03)D03,SUM(B.D04)D04,SUM(B.D05)D05,
SUM(B.D06)D06,SUM(B.D07)D07,SUM(B.D08)D08,SUM(B.D09)D09,SUM(B.D10)D10,
SUM(B.D11)D11,SUM(B.D12)D12,SUM(B.D13)D13,SUM(B.D14)D14,SUM(B.D15)D15,
SUM(B.D16)D16,SUM(B.D17)D17,SUM(B.D18)D18,SUM(B.D19)D19,SUM(B.D20)D20,
SUM(B.D21)D21,SUM(B.D22)D22,SUM(B.D23)D23,SUM(B.D24)D24,SUM(B.D25)D25,
SUM(B.D26)D26,SUM(B.D27)D27,SUM(B.D28)D28,SUM(B.D29)D29,SUM(B.D30)D30,
(SUM(B.D00)+SUM(B.D01)+SUM(B.D02)+SUM(B.D03)+SUM(B.D04)+SUM(B.D05)+SUM(B.D06)+SUM(B.D07)+SUM(B.D08)+SUM(B.D09)+SUM(B.D10)+
SUM(B.D11)+SUM(B.D12)+SUM(B.D13)+SUM(B.D14)+SUM(B.D15)+SUM(B.D16)+SUM(B.D17)+SUM(B.D18)+SUM(B.D19)+SUM(B.D20)+
SUM(B.D21)+SUM(B.D22)+SUM(B.D23)+SUM(B.D24)+SUM(B.D25)+SUM(B.D26)+SUM(B.D27)+SUM(B.D28)+SUM(B.D29)+SUM(B.D30)
)TOTAL
FROM (
SELECT A.IDARTICULO,A.DESCRIPCION,
CASE DIA WHEN 0 THEN CANTIDAD ELSE 0 END D00,
CASE DIA WHEN 1 THEN CANTIDAD ELSE 0 END D01,
CASE DIA WHEN 2 THEN CANTIDAD ELSE 0 END D02,
CASE DIA WHEN 3 THEN CANTIDAD ELSE 0 END D03,
CASE DIA WHEN 4 THEN CANTIDAD ELSE 0 END D04,
CASE DIA WHEN 5 THEN CANTIDAD ELSE 0 END D05,
CASE DIA WHEN 6 THEN CANTIDAD ELSE 0 END D06,
CASE DIA WHEN 7 THEN CANTIDAD ELSE 0 END D07,
CASE DIA WHEN 8 THEN CANTIDAD ELSE 0 END D08,
CASE DIA WHEN 9 THEN CANTIDAD ELSE 0 END D09,
CASE DIA WHEN 10 THEN CANTIDAD ELSE 0 END D10,
CASE DIA WHEN 11 THEN CANTIDAD ELSE 0 END D11,
CASE DIA WHEN 12 THEN CANTIDAD ELSE 0 END D12,
CASE DIA WHEN 13 THEN CANTIDAD ELSE 0 END D13,
CASE DIA WHEN 14 THEN CANTIDAD ELSE 0 END D14,
CASE DIA WHEN 15 THEN CANTIDAD ELSE 0 END D15,
CASE DIA WHEN 16 THEN CANTIDAD ELSE 0 END D16,
CASE DIA WHEN 17 THEN CANTIDAD ELSE 0 END D17,
CASE DIA WHEN 18 THEN CANTIDAD ELSE 0 END D18,
CASE DIA WHEN 19 THEN CANTIDAD ELSE 0 END D19,
CASE DIA WHEN 20 THEN CANTIDAD ELSE 0 END D20,
CASE DIA WHEN 21 THEN CANTIDAD ELSE 0 END D21,
CASE DIA WHEN 22 THEN CANTIDAD ELSE 0 END D22,
CASE DIA WHEN 23 THEN CANTIDAD ELSE 0 END D23,
CASE DIA WHEN 24 THEN CANTIDAD ELSE 0 END D24,
CASE DIA WHEN 25 THEN CANTIDAD ELSE 0 END D25,
CASE DIA WHEN 26 THEN CANTIDAD ELSE 0 END D26,
CASE DIA WHEN 27 THEN CANTIDAD ELSE 0 END D27,
CASE DIA WHEN 28 THEN CANTIDAD ELSE 0 END D28,
CASE DIA WHEN 29 THEN CANTIDAD ELSE 0 END D29,
CASE DIA WHEN 30 THEN CANTIDAD ELSE 0 END D30
FROM (
SELECT B.IDARTICULO,C.DESCRIPCION,CONVERT(INT,B.CANTIDAD)CANTIDAD,DATEDIFF(DAY,D.FECHA,A.FECHACONF)DIA
FROM IMOV A INNER JOIN IMOVH B ON A.CNSMOV=B.CNSMOV
            INNER JOIN IART  C ON B.IDARTICULO=C.IDARTICULO
            INNER JOIN HADM  D ON A.NODOCUMENTO=D.NOADMISION
WHERE A.NODOCUMENTO=@NOADMISION AND C.IDITAR IN('01','02') AND  B.ESTADO=1) A)B
GROUP BY B.IDARTICULO,B.DESCRIPCION

END
IF @NUMER>=31 AND @NUMER<=40
BEGIN
PRINT 'BLOQUE 3'

INSERT INTO PERFAR(IDARTICULO,DESCRIPCION,	D00,  
	D01,	D02,	D03,	D04,	D05,	D06,	D07,	D08,	D09,  D10,
	D11,	D12,	D13,	D14,	D15,	D16,  D17,  D18,  D19,  D20,
	D21,	D22,	D23,	D24,	D25,	D26,	D27,	D28,	D29,	D30,
	D31,	D32,	D33,	D34,	D35,	D36,	D37,	D38,	D39,	D40,TOTAL)

SELECT B.IDARTICULO,B.DESCRIPCION,
SUM(B.D00)D00,SUM(B.D01)D01,SUM(B.D02)D02,SUM(B.D03)D03,SUM(B.D04)D04,SUM(B.D05)D05,
SUM(B.D06)D06,SUM(B.D07)D07,SUM(B.D08)D08,SUM(B.D09)D09,SUM(B.D10)D10,
SUM(B.D11)D11,SUM(B.D12)D12,SUM(B.D13)D13,SUM(B.D14)D14,SUM(B.D15)D15,
SUM(B.D16)D16,SUM(B.D17)D17,SUM(B.D18)D18,SUM(B.D19)D19,SUM(B.D20)D20,
SUM(B.D21)D21,SUM(B.D22)D22,SUM(B.D23)D23,SUM(B.D24)D24,SUM(B.D25)D25,
SUM(B.D26)D26,SUM(B.D27)D27,SUM(B.D28)D28,SUM(B.D29)D29,SUM(B.D30)D30,
SUM(B.D31)D31,SUM(B.D32)D32,SUM(B.D33)D33,SUM(B.D34)D34,SUM(B.D35)D35,
SUM(B.D36)D36,SUM(B.D37)D37,SUM(B.D38)D38,SUM(B.D39)D39,SUM(B.D40)D40,
(SUM(B.D00)+SUM(B.D01)+SUM(B.D02)+SUM(B.D03)+SUM(B.D04)+SUM(B.D05)+SUM(B.D06)+SUM(B.D07)+SUM(B.D08)+SUM(B.D09)+SUM(B.D10)+
SUM(B.D11)+SUM(B.D12)+SUM(B.D13)+SUM(B.D14)+SUM(B.D15)+SUM(B.D16)+SUM(B.D17)+SUM(B.D18)+SUM(B.D19)+SUM(B.D20)+
SUM(B.D21)+SUM(B.D22)+SUM(B.D23)+SUM(B.D24)+SUM(B.D25)+SUM(B.D26)+SUM(B.D27)+SUM(B.D28)+SUM(B.D29)+SUM(B.D30)+
SUM(B.D31)+SUM(B.D32)+SUM(B.D33)+SUM(B.D34)+SUM(B.D35)+SUM(B.D36)+SUM(B.D37)+SUM(B.D38)+SUM(B.D39)+SUM(B.D40)
)TOTAL
FROM (
SELECT A.IDARTICULO,A.DESCRIPCION,
CASE DIA WHEN 0 THEN CANTIDAD ELSE 0 END D00,
CASE DIA WHEN 1 THEN CANTIDAD ELSE 0 END D01,
CASE DIA WHEN 2 THEN CANTIDAD ELSE 0 END D02,
CASE DIA WHEN 3 THEN CANTIDAD ELSE 0 END D03,
CASE DIA WHEN 4 THEN CANTIDAD ELSE 0 END D04,
CASE DIA WHEN 5 THEN CANTIDAD ELSE 0 END D05,
CASE DIA WHEN 6 THEN CANTIDAD ELSE 0 END D06,
CASE DIA WHEN 7 THEN CANTIDAD ELSE 0 END D07,
CASE DIA WHEN 8 THEN CANTIDAD ELSE 0 END D08,
CASE DIA WHEN 9 THEN CANTIDAD ELSE 0 END D09,
CASE DIA WHEN 10 THEN CANTIDAD ELSE 0 END D10,
CASE DIA WHEN 11 THEN CANTIDAD ELSE 0 END D11,
CASE DIA WHEN 12 THEN CANTIDAD ELSE 0 END D12,
CASE DIA WHEN 13 THEN CANTIDAD ELSE 0 END D13,
CASE DIA WHEN 14 THEN CANTIDAD ELSE 0 END D14,
CASE DIA WHEN 15 THEN CANTIDAD ELSE 0 END D15,
CASE DIA WHEN 16 THEN CANTIDAD ELSE 0 END D16,
CASE DIA WHEN 17 THEN CANTIDAD ELSE 0 END D17,
CASE DIA WHEN 18 THEN CANTIDAD ELSE 0 END D18,
CASE DIA WHEN 19 THEN CANTIDAD ELSE 0 END D19,
CASE DIA WHEN 20 THEN CANTIDAD ELSE 0 END D20,
CASE DIA WHEN 21 THEN CANTIDAD ELSE 0 END D21,
CASE DIA WHEN 22 THEN CANTIDAD ELSE 0 END D22,
CASE DIA WHEN 23 THEN CANTIDAD ELSE 0 END D23,
CASE DIA WHEN 24 THEN CANTIDAD ELSE 0 END D24,
CASE DIA WHEN 25 THEN CANTIDAD ELSE 0 END D25,
CASE DIA WHEN 26 THEN CANTIDAD ELSE 0 END D26,
CASE DIA WHEN 27 THEN CANTIDAD ELSE 0 END D27,
CASE DIA WHEN 28 THEN CANTIDAD ELSE 0 END D28,
CASE DIA WHEN 29 THEN CANTIDAD ELSE 0 END D29,
CASE DIA WHEN 30 THEN CANTIDAD ELSE 0 END D30,
CASE DIA WHEN 31 THEN CANTIDAD ELSE 0 END D31,
CASE DIA WHEN 32 THEN CANTIDAD ELSE 0 END D32,
CASE DIA WHEN 33 THEN CANTIDAD ELSE 0 END D33,
CASE DIA WHEN 34 THEN CANTIDAD ELSE 0 END D34,
CASE DIA WHEN 35 THEN CANTIDAD ELSE 0 END D35,
CASE DIA WHEN 36 THEN CANTIDAD ELSE 0 END D36,
CASE DIA WHEN 37 THEN CANTIDAD ELSE 0 END D37,
CASE DIA WHEN 38 THEN CANTIDAD ELSE 0 END D38,
CASE DIA WHEN 39 THEN CANTIDAD ELSE 0 END D39,
CASE DIA WHEN 40 THEN CANTIDAD ELSE 0 END D40
FROM (
SELECT B.IDARTICULO,C.DESCRIPCION,CONVERT(INT,B.CANTIDAD)CANTIDAD,DATEDIFF(DAY,D.FECHA,A.FECHACONF)DIA
FROM IMOV A INNER JOIN IMOVH B ON A.CNSMOV=B.CNSMOV
            INNER JOIN IART  C ON B.IDARTICULO=C.IDARTICULO
            INNER JOIN HADM  D ON A.NODOCUMENTO=D.NOADMISION
WHERE A.NODOCUMENTO=@NOADMISION AND C.IDITAR IN('01','02') AND  B.ESTADO=1) A)B
GROUP BY B.IDARTICULO,B.DESCRIPCION

END
IF @NUMER>=41 AND @NUMER<=50
BEGIN
PRINT 'BLOQUE 4'

INSERT INTO PERFAR(	IDARTICULO,DESCRIPCION,	D00,  
	D01,	D02,	D03,	D04,	D05,	D06,	D07,	D08,	D09,  D10,
	D11,	D12,	D13,	D14,	D15,	D16,  D17,  D18,  D19,  D20,
	D21,	D22,	D23,	D24,	D25,	D26,	D27,	D28,	D29,	D30,
	D31,	D32,	D33,	D34,	D35,	D36,	D37,	D38,	D39,	D40,
	D41,	D42,	D43,	D44,	D45,	D46,	D47,	D48,	D49,	D50,TOTAL)

SELECT B.IDARTICULO,B.DESCRIPCION,
SUM(B.D00)D00,SUM(B.D01)D01,SUM(B.D02)D02,SUM(B.D03)D03,SUM(B.D04)D04,SUM(B.D05)D05,
SUM(B.D06)D06,SUM(B.D07)D07,SUM(B.D08)D08,SUM(B.D09)D09,SUM(B.D10)D10,
SUM(B.D11)D11,SUM(B.D12)D12,SUM(B.D13)D13,SUM(B.D14)D14,SUM(B.D15)D15,
SUM(B.D16)D16,SUM(B.D17)D17,SUM(B.D18)D18,SUM(B.D19)D19,SUM(B.D20)D20,
SUM(B.D21)D21,SUM(B.D22)D22,SUM(B.D23)D23,SUM(B.D24)D24,SUM(B.D25)D25,
SUM(B.D26)D26,SUM(B.D27)D27,SUM(B.D28)D28,SUM(B.D29)D29,SUM(B.D30)D30,
SUM(B.D31)D31,SUM(B.D32)D32,SUM(B.D33)D33,SUM(B.D34)D34,SUM(B.D35)D35,
SUM(B.D36)D36,SUM(B.D37)D37,SUM(B.D38)D38,SUM(B.D39)D39,SUM(B.D40)D40,
SUM(B.D41)D41,SUM(B.D42)D42,SUM(B.D43)D43,SUM(B.D44)D44,SUM(B.D45)D45,
SUM(B.D46)D46,SUM(B.D47)D47,SUM(B.D48)D48,SUM(B.D49)D49,SUM(B.D50)D50,
(SUM(B.D00)+SUM(B.D01)+SUM(B.D02)+SUM(B.D03)+SUM(B.D04)+SUM(B.D05)+SUM(B.D06)+SUM(B.D07)+SUM(B.D08)+SUM(B.D09)+SUM(B.D10)+
SUM(B.D11)+SUM(B.D12)+SUM(B.D13)+SUM(B.D14)+SUM(B.D15)+SUM(B.D16)+SUM(B.D17)+SUM(B.D18)+SUM(B.D19)+SUM(B.D20)+
SUM(B.D21)+SUM(B.D22)+SUM(B.D23)+SUM(B.D24)+SUM(B.D25)+SUM(B.D26)+SUM(B.D27)+SUM(B.D28)+SUM(B.D29)+SUM(B.D30)+
SUM(B.D31)+SUM(B.D32)+SUM(B.D33)+SUM(B.D34)+SUM(B.D35)+SUM(B.D36)+SUM(B.D37)+SUM(B.D38)+SUM(B.D39)+SUM(B.D40)+
SUM(B.D41)+SUM(B.D42)+SUM(B.D43)+SUM(B.D44)+SUM(B.D45)+SUM(B.D46)+SUM(B.D47)+SUM(B.D48)+SUM(B.D49)+SUM(B.D50)
)TOTAL
FROM (
SELECT A.IDARTICULO,A.DESCRIPCION,
CASE DIA WHEN 0 THEN CANTIDAD ELSE 0 END D00,
CASE DIA WHEN 1 THEN CANTIDAD ELSE 0 END D01,
CASE DIA WHEN 2 THEN CANTIDAD ELSE 0 END D02,
CASE DIA WHEN 3 THEN CANTIDAD ELSE 0 END D03,
CASE DIA WHEN 4 THEN CANTIDAD ELSE 0 END D04,
CASE DIA WHEN 5 THEN CANTIDAD ELSE 0 END D05,
CASE DIA WHEN 6 THEN CANTIDAD ELSE 0 END D06,
CASE DIA WHEN 7 THEN CANTIDAD ELSE 0 END D07,
CASE DIA WHEN 8 THEN CANTIDAD ELSE 0 END D08,
CASE DIA WHEN 9 THEN CANTIDAD ELSE 0 END D09,
CASE DIA WHEN 10 THEN CANTIDAD ELSE 0 END D10,
CASE DIA WHEN 11 THEN CANTIDAD ELSE 0 END D11,
CASE DIA WHEN 12 THEN CANTIDAD ELSE 0 END D12,
CASE DIA WHEN 13 THEN CANTIDAD ELSE 0 END D13,
CASE DIA WHEN 14 THEN CANTIDAD ELSE 0 END D14,
CASE DIA WHEN 15 THEN CANTIDAD ELSE 0 END D15,
CASE DIA WHEN 16 THEN CANTIDAD ELSE 0 END D16,
CASE DIA WHEN 17 THEN CANTIDAD ELSE 0 END D17,
CASE DIA WHEN 18 THEN CANTIDAD ELSE 0 END D18,
CASE DIA WHEN 19 THEN CANTIDAD ELSE 0 END D19,
CASE DIA WHEN 20 THEN CANTIDAD ELSE 0 END D20,
CASE DIA WHEN 21 THEN CANTIDAD ELSE 0 END D21,
CASE DIA WHEN 22 THEN CANTIDAD ELSE 0 END D22,
CASE DIA WHEN 23 THEN CANTIDAD ELSE 0 END D23,
CASE DIA WHEN 24 THEN CANTIDAD ELSE 0 END D24,
CASE DIA WHEN 25 THEN CANTIDAD ELSE 0 END D25,
CASE DIA WHEN 26 THEN CANTIDAD ELSE 0 END D26,
CASE DIA WHEN 27 THEN CANTIDAD ELSE 0 END D27,
CASE DIA WHEN 28 THEN CANTIDAD ELSE 0 END D28,
CASE DIA WHEN 29 THEN CANTIDAD ELSE 0 END D29,
CASE DIA WHEN 30 THEN CANTIDAD ELSE 0 END D30,
CASE DIA WHEN 31 THEN CANTIDAD ELSE 0 END D31,
CASE DIA WHEN 32 THEN CANTIDAD ELSE 0 END D32,
CASE DIA WHEN 33 THEN CANTIDAD ELSE 0 END D33,
CASE DIA WHEN 34 THEN CANTIDAD ELSE 0 END D34,
CASE DIA WHEN 35 THEN CANTIDAD ELSE 0 END D35,
CASE DIA WHEN 36 THEN CANTIDAD ELSE 0 END D36,
CASE DIA WHEN 37 THEN CANTIDAD ELSE 0 END D37,
CASE DIA WHEN 38 THEN CANTIDAD ELSE 0 END D38,
CASE DIA WHEN 39 THEN CANTIDAD ELSE 0 END D39,
CASE DIA WHEN 40 THEN CANTIDAD ELSE 0 END D40,
CASE DIA WHEN 41 THEN CANTIDAD ELSE 0 END D41,
CASE DIA WHEN 42 THEN CANTIDAD ELSE 0 END D42,
CASE DIA WHEN 43 THEN CANTIDAD ELSE 0 END D43,
CASE DIA WHEN 44 THEN CANTIDAD ELSE 0 END D44,
CASE DIA WHEN 45 THEN CANTIDAD ELSE 0 END D45,
CASE DIA WHEN 46 THEN CANTIDAD ELSE 0 END D46,
CASE DIA WHEN 47 THEN CANTIDAD ELSE 0 END D47,
CASE DIA WHEN 48 THEN CANTIDAD ELSE 0 END D48,
CASE DIA WHEN 49 THEN CANTIDAD ELSE 0 END D49,
CASE DIA WHEN 50 THEN CANTIDAD ELSE 0 END D50
FROM (
SELECT B.IDARTICULO,C.DESCRIPCION,CONVERT(INT,B.CANTIDAD)CANTIDAD,DATEDIFF(DAY,D.FECHA,A.FECHACONF)DIA
FROM IMOV A INNER JOIN IMOVH B ON A.CNSMOV=B.CNSMOV
            INNER JOIN IART  C ON B.IDARTICULO=C.IDARTICULO
            INNER JOIN HADM  D ON A.NODOCUMENTO=D.NOADMISION
WHERE A.NODOCUMENTO=@NOADMISION AND C.IDITAR IN('01','02') AND  B.ESTADO=1) A)B
GROUP BY B.IDARTICULO,B.DESCRIPCION


END
IF @NUMER>=51 AND @NUMER<=60
BEGIN
PRINT 'BLOQUE 5'

INSERT INTO PERFAR(	IDARTICULO,DESCRIPCION,	D00,  
	D01,	D02,	D03,	D04,	D05,	D06,	D07,	D08,	D09,  D10,
	D11,	D12,	D13,	D14,	D15,	D16,  D17,  D18,  D19,  D20,
	D21,	D22,	D23,	D24,	D25,	D26,	D27,	D28,	D29,	D30,
	D31,	D32,	D33,	D34,	D35,	D36,	D37,	D38,	D39,	D40,
	D41,	D42,	D43,	D44,	D45,	D46,	D47,	D48,	D49,	D50,
	D51,	D52,	D53,	D54,	D55,	D56,	D57,	D58,	D59,	D60,TOTAL)

SELECT B.IDARTICULO,B.DESCRIPCION,
SUM(B.D00)D00,SUM(B.D01)D01,SUM(B.D02)D02,SUM(B.D03)D03,SUM(B.D04)D04,SUM(B.D05)D05,
SUM(B.D06)D06,SUM(B.D07)D07,SUM(B.D08)D08,SUM(B.D09)D09,SUM(B.D10)D10,
SUM(B.D11)D11,SUM(B.D12)D12,SUM(B.D13)D13,SUM(B.D14)D14,SUM(B.D15)D15,
SUM(B.D16)D16,SUM(B.D17)D17,SUM(B.D18)D18,SUM(B.D19)D19,SUM(B.D20)D20,
SUM(B.D21)D21,SUM(B.D22)D22,SUM(B.D23)D23,SUM(B.D24)D24,SUM(B.D25)D25,
SUM(B.D26)D26,SUM(B.D27)D27,SUM(B.D28)D28,SUM(B.D29)D29,SUM(B.D30)D30,
SUM(B.D31)D31,SUM(B.D32)D32,SUM(B.D33)D33,SUM(B.D34)D34,SUM(B.D35)D35,
SUM(B.D36)D36,SUM(B.D37)D37,SUM(B.D38)D38,SUM(B.D39)D39,SUM(B.D40)D40,
SUM(B.D41)D41,SUM(B.D42)D42,SUM(B.D43)D43,SUM(B.D44)D44,SUM(B.D45)D45,
SUM(B.D46)D46,SUM(B.D47)D47,SUM(B.D48)D48,SUM(B.D49)D49,SUM(B.D50)D50,
SUM(B.D51)D51,SUM(B.D52)D52,SUM(B.D53)D53,SUM(B.D54)D54,SUM(B.D55)D55,
SUM(B.D56)D56,SUM(B.D57)D57,SUM(B.D58)D58,SUM(B.D59)D59,SUM(B.D60)D60,
(SUM(B.D00)+SUM(B.D01)+SUM(B.D02)+SUM(B.D03)+SUM(B.D04)+SUM(B.D05)+SUM(B.D06)+SUM(B.D07)+SUM(B.D08)+SUM(B.D09)+SUM(B.D10)+
SUM(B.D11)+SUM(B.D12)+SUM(B.D13)+SUM(B.D14)+SUM(B.D15)+SUM(B.D16)+SUM(B.D17)+SUM(B.D18)+SUM(B.D19)+SUM(B.D20)+
SUM(B.D21)+SUM(B.D22)+SUM(B.D23)+SUM(B.D24)+SUM(B.D25)+SUM(B.D26)+SUM(B.D27)+SUM(B.D28)+SUM(B.D29)+SUM(B.D30)+
SUM(B.D31)+SUM(B.D32)+SUM(B.D33)+SUM(B.D34)+SUM(B.D35)+SUM(B.D36)+SUM(B.D37)+SUM(B.D38)+SUM(B.D39)+SUM(B.D40)+
SUM(B.D41)+SUM(B.D42)+SUM(B.D43)+SUM(B.D44)+SUM(B.D45)+SUM(B.D46)+SUM(B.D47)+SUM(B.D48)+SUM(B.D49)+SUM(B.D50)+
SUM(B.D51)+SUM(B.D52)+SUM(B.D53)+SUM(B.D54)+SUM(B.D55)+SUM(B.D56)+SUM(B.D57)+SUM(B.D58)+SUM(B.D59)+SUM(B.D60)
)TOTAL
FROM (
SELECT A.IDARTICULO,A.DESCRIPCION,
CASE DIA WHEN 0 THEN CANTIDAD ELSE 0 END D00,
CASE DIA WHEN 1 THEN CANTIDAD ELSE 0 END D01,
CASE DIA WHEN 2 THEN CANTIDAD ELSE 0 END D02,
CASE DIA WHEN 3 THEN CANTIDAD ELSE 0 END D03,
CASE DIA WHEN 4 THEN CANTIDAD ELSE 0 END D04,
CASE DIA WHEN 5 THEN CANTIDAD ELSE 0 END D05,
CASE DIA WHEN 6 THEN CANTIDAD ELSE 0 END D06,
CASE DIA WHEN 7 THEN CANTIDAD ELSE 0 END D07,
CASE DIA WHEN 8 THEN CANTIDAD ELSE 0 END D08,
CASE DIA WHEN 9 THEN CANTIDAD ELSE 0 END D09,
CASE DIA WHEN 10 THEN CANTIDAD ELSE 0 END D10,
CASE DIA WHEN 11 THEN CANTIDAD ELSE 0 END D11,
CASE DIA WHEN 12 THEN CANTIDAD ELSE 0 END D12,
CASE DIA WHEN 13 THEN CANTIDAD ELSE 0 END D13,
CASE DIA WHEN 14 THEN CANTIDAD ELSE 0 END D14,
CASE DIA WHEN 15 THEN CANTIDAD ELSE 0 END D15,
CASE DIA WHEN 16 THEN CANTIDAD ELSE 0 END D16,
CASE DIA WHEN 17 THEN CANTIDAD ELSE 0 END D17,
CASE DIA WHEN 18 THEN CANTIDAD ELSE 0 END D18,
CASE DIA WHEN 19 THEN CANTIDAD ELSE 0 END D19,
CASE DIA WHEN 20 THEN CANTIDAD ELSE 0 END D20,
CASE DIA WHEN 21 THEN CANTIDAD ELSE 0 END D21,
CASE DIA WHEN 22 THEN CANTIDAD ELSE 0 END D22,
CASE DIA WHEN 23 THEN CANTIDAD ELSE 0 END D23,
CASE DIA WHEN 24 THEN CANTIDAD ELSE 0 END D24,
CASE DIA WHEN 25 THEN CANTIDAD ELSE 0 END D25,
CASE DIA WHEN 26 THEN CANTIDAD ELSE 0 END D26,
CASE DIA WHEN 27 THEN CANTIDAD ELSE 0 END D27,
CASE DIA WHEN 28 THEN CANTIDAD ELSE 0 END D28,
CASE DIA WHEN 29 THEN CANTIDAD ELSE 0 END D29,
CASE DIA WHEN 30 THEN CANTIDAD ELSE 0 END D30,
CASE DIA WHEN 31 THEN CANTIDAD ELSE 0 END D31,
CASE DIA WHEN 32 THEN CANTIDAD ELSE 0 END D32,
CASE DIA WHEN 33 THEN CANTIDAD ELSE 0 END D33,
CASE DIA WHEN 34 THEN CANTIDAD ELSE 0 END D34,
CASE DIA WHEN 35 THEN CANTIDAD ELSE 0 END D35,
CASE DIA WHEN 36 THEN CANTIDAD ELSE 0 END D36,
CASE DIA WHEN 37 THEN CANTIDAD ELSE 0 END D37,
CASE DIA WHEN 38 THEN CANTIDAD ELSE 0 END D38,
CASE DIA WHEN 39 THEN CANTIDAD ELSE 0 END D39,
CASE DIA WHEN 40 THEN CANTIDAD ELSE 0 END D40,
CASE DIA WHEN 41 THEN CANTIDAD ELSE 0 END D41,
CASE DIA WHEN 42 THEN CANTIDAD ELSE 0 END D42,
CASE DIA WHEN 43 THEN CANTIDAD ELSE 0 END D43,
CASE DIA WHEN 44 THEN CANTIDAD ELSE 0 END D44,
CASE DIA WHEN 45 THEN CANTIDAD ELSE 0 END D45,
CASE DIA WHEN 46 THEN CANTIDAD ELSE 0 END D46,
CASE DIA WHEN 47 THEN CANTIDAD ELSE 0 END D47,
CASE DIA WHEN 48 THEN CANTIDAD ELSE 0 END D48,
CASE DIA WHEN 49 THEN CANTIDAD ELSE 0 END D49,
CASE DIA WHEN 50 THEN CANTIDAD ELSE 0 END D50,
CASE DIA WHEN 51 THEN CANTIDAD ELSE 0 END D51,
CASE DIA WHEN 52 THEN CANTIDAD ELSE 0 END D52,
CASE DIA WHEN 53 THEN CANTIDAD ELSE 0 END D53,
CASE DIA WHEN 54 THEN CANTIDAD ELSE 0 END D54,
CASE DIA WHEN 55 THEN CANTIDAD ELSE 0 END D55,
CASE DIA WHEN 56 THEN CANTIDAD ELSE 0 END D56,
CASE DIA WHEN 57 THEN CANTIDAD ELSE 0 END D57,
CASE DIA WHEN 58 THEN CANTIDAD ELSE 0 END D58,
CASE DIA WHEN 59 THEN CANTIDAD ELSE 0 END D59,
CASE DIA WHEN 60 THEN CANTIDAD ELSE 0 END D60
FROM (
SELECT B.IDARTICULO,C.DESCRIPCION,CONVERT(INT,B.CANTIDAD)CANTIDAD,DATEDIFF(DAY,D.FECHA,A.FECHACONF)DIA
FROM IMOV A INNER JOIN IMOVH B ON A.CNSMOV=B.CNSMOV
            INNER JOIN IART  C ON B.IDARTICULO=C.IDARTICULO
            INNER JOIN HADM  D ON A.NODOCUMENTO=D.NOADMISION
WHERE A.NODOCUMENTO=@NOADMISION AND C.IDITAR IN('01','02') AND  B.ESTADO=1) A)B
GROUP BY B.IDARTICULO,B.DESCRIPCION


END
IF @NUMER>=61 AND @NUMER<=70
BEGIN
PRINT 'BLOQUE 6'

INSERT INTO PERFAR(	IDARTICULO,DESCRIPCION,	D00,  
	D01,	D02,	D03,	D04,	D05,	D06,	D07,	D08,	D09,  D10,
	D11,	D12,	D13,	D14,	D15,	D16,  D17,  D18,  D19,  D20,
	D21,	D22,	D23,	D24,	D25,	D26,	D27,	D28,	D29,	D30,
	D31,	D32,	D33,	D34,	D35,	D36,	D37,	D38,	D39,	D40,
	D41,	D42,	D43,	D44,	D45,	D46,	D47,	D48,	D49,	D50,
	D51,	D52,	D53,	D54,	D55,	D56,	D57,	D58,	D59,	D60,
	D61,	D62,	D63,	D64,	D65,	D66,	D67,	D68,	D69,	D70,TOTAL)

SELECT B.IDARTICULO,B.DESCRIPCION,
SUM(B.D00)D00,SUM(B.D01)D01,SUM(B.D02)D02,SUM(B.D03)D03,SUM(B.D04)D04,SUM(B.D05)D05,
SUM(B.D06)D06,SUM(B.D07)D07,SUM(B.D08)D08,SUM(B.D09)D09,SUM(B.D10)D10,
SUM(B.D11)D11,SUM(B.D12)D12,SUM(B.D13)D13,SUM(B.D14)D14,SUM(B.D15)D15,
SUM(B.D16)D16,SUM(B.D17)D17,SUM(B.D18)D18,SUM(B.D19)D19,SUM(B.D20)D20,
SUM(B.D21)D21,SUM(B.D22)D22,SUM(B.D23)D23,SUM(B.D24)D24,SUM(B.D25)D25,
SUM(B.D26)D26,SUM(B.D27)D27,SUM(B.D28)D28,SUM(B.D29)D29,SUM(B.D30)D30,
SUM(B.D31)D31,SUM(B.D32)D32,SUM(B.D33)D33,SUM(B.D34)D34,SUM(B.D35)D35,
SUM(B.D36)D36,SUM(B.D37)D37,SUM(B.D38)D38,SUM(B.D39)D39,SUM(B.D40)D40,
SUM(B.D41)D41,SUM(B.D42)D42,SUM(B.D43)D43,SUM(B.D44)D44,SUM(B.D45)D45,
SUM(B.D46)D46,SUM(B.D47)D47,SUM(B.D48)D48,SUM(B.D49)D49,SUM(B.D50)D50,
SUM(B.D51)D51,SUM(B.D52)D52,SUM(B.D53)D53,SUM(B.D54)D54,SUM(B.D55)D55,
SUM(B.D56)D56,SUM(B.D57)D57,SUM(B.D58)D58,SUM(B.D59)D59,SUM(B.D60)D60,
SUM(B.D61)D61,SUM(B.D62)D62,SUM(B.D63)D63,SUM(B.D64)D64,SUM(B.D65)D65,
SUM(B.D66)D66,SUM(B.D67)D67,SUM(B.D68)D68,SUM(B.D69)D69,SUM(B.D70)D70,
(SUM(B.D00)+SUM(B.D01)+SUM(B.D02)+SUM(B.D03)+SUM(B.D04)+SUM(B.D05)+SUM(B.D06)+SUM(B.D07)+SUM(B.D08)+SUM(B.D09)+SUM(B.D10)+
SUM(B.D11)+SUM(B.D12)+SUM(B.D13)+SUM(B.D14)+SUM(B.D15)+SUM(B.D16)+SUM(B.D17)+SUM(B.D18)+SUM(B.D19)+SUM(B.D20)+
SUM(B.D21)+SUM(B.D22)+SUM(B.D23)+SUM(B.D24)+SUM(B.D25)+SUM(B.D26)+SUM(B.D27)+SUM(B.D28)+SUM(B.D29)+SUM(B.D30)+
SUM(B.D31)+SUM(B.D32)+SUM(B.D33)+SUM(B.D34)+SUM(B.D35)+SUM(B.D36)+SUM(B.D37)+SUM(B.D38)+SUM(B.D39)+SUM(B.D40)+
SUM(B.D41)+SUM(B.D42)+SUM(B.D43)+SUM(B.D44)+SUM(B.D45)+SUM(B.D46)+SUM(B.D47)+SUM(B.D48)+SUM(B.D49)+SUM(B.D50)+
SUM(B.D51)+SUM(B.D52)+SUM(B.D53)+SUM(B.D54)+SUM(B.D55)+SUM(B.D56)+SUM(B.D57)+SUM(B.D58)+SUM(B.D59)+SUM(B.D60)+
SUM(B.D61)+SUM(B.D62)+SUM(B.D63)+SUM(B.D64)+SUM(B.D65)+SUM(B.D66)+SUM(B.D67)+SUM(B.D68)+SUM(B.D69)+SUM(B.D70)
)TOTAL
FROM (
SELECT A.IDARTICULO,A.DESCRIPCION,
CASE DIA WHEN 0 THEN CANTIDAD ELSE 0 END D00,
CASE DIA WHEN 1 THEN CANTIDAD ELSE 0 END D01,
CASE DIA WHEN 2 THEN CANTIDAD ELSE 0 END D02,
CASE DIA WHEN 3 THEN CANTIDAD ELSE 0 END D03,
CASE DIA WHEN 4 THEN CANTIDAD ELSE 0 END D04,
CASE DIA WHEN 5 THEN CANTIDAD ELSE 0 END D05,
CASE DIA WHEN 6 THEN CANTIDAD ELSE 0 END D06,
CASE DIA WHEN 7 THEN CANTIDAD ELSE 0 END D07,
CASE DIA WHEN 8 THEN CANTIDAD ELSE 0 END D08,
CASE DIA WHEN 9 THEN CANTIDAD ELSE 0 END D09,
CASE DIA WHEN 10 THEN CANTIDAD ELSE 0 END D10,
CASE DIA WHEN 11 THEN CANTIDAD ELSE 0 END D11,
CASE DIA WHEN 12 THEN CANTIDAD ELSE 0 END D12,
CASE DIA WHEN 13 THEN CANTIDAD ELSE 0 END D13,
CASE DIA WHEN 14 THEN CANTIDAD ELSE 0 END D14,
CASE DIA WHEN 15 THEN CANTIDAD ELSE 0 END D15,
CASE DIA WHEN 16 THEN CANTIDAD ELSE 0 END D16,
CASE DIA WHEN 17 THEN CANTIDAD ELSE 0 END D17,
CASE DIA WHEN 18 THEN CANTIDAD ELSE 0 END D18,
CASE DIA WHEN 19 THEN CANTIDAD ELSE 0 END D19,
CASE DIA WHEN 20 THEN CANTIDAD ELSE 0 END D20,
CASE DIA WHEN 21 THEN CANTIDAD ELSE 0 END D21,
CASE DIA WHEN 22 THEN CANTIDAD ELSE 0 END D22,
CASE DIA WHEN 23 THEN CANTIDAD ELSE 0 END D23,
CASE DIA WHEN 24 THEN CANTIDAD ELSE 0 END D24,
CASE DIA WHEN 25 THEN CANTIDAD ELSE 0 END D25,
CASE DIA WHEN 26 THEN CANTIDAD ELSE 0 END D26,
CASE DIA WHEN 27 THEN CANTIDAD ELSE 0 END D27,
CASE DIA WHEN 28 THEN CANTIDAD ELSE 0 END D28,
CASE DIA WHEN 29 THEN CANTIDAD ELSE 0 END D29,
CASE DIA WHEN 30 THEN CANTIDAD ELSE 0 END D30,
CASE DIA WHEN 31 THEN CANTIDAD ELSE 0 END D31,
CASE DIA WHEN 32 THEN CANTIDAD ELSE 0 END D32,
CASE DIA WHEN 33 THEN CANTIDAD ELSE 0 END D33,
CASE DIA WHEN 34 THEN CANTIDAD ELSE 0 END D34,
CASE DIA WHEN 35 THEN CANTIDAD ELSE 0 END D35,
CASE DIA WHEN 36 THEN CANTIDAD ELSE 0 END D36,
CASE DIA WHEN 37 THEN CANTIDAD ELSE 0 END D37,
CASE DIA WHEN 38 THEN CANTIDAD ELSE 0 END D38,
CASE DIA WHEN 39 THEN CANTIDAD ELSE 0 END D39,
CASE DIA WHEN 40 THEN CANTIDAD ELSE 0 END D40,
CASE DIA WHEN 41 THEN CANTIDAD ELSE 0 END D41,
CASE DIA WHEN 42 THEN CANTIDAD ELSE 0 END D42,
CASE DIA WHEN 43 THEN CANTIDAD ELSE 0 END D43,
CASE DIA WHEN 44 THEN CANTIDAD ELSE 0 END D44,
CASE DIA WHEN 45 THEN CANTIDAD ELSE 0 END D45,
CASE DIA WHEN 46 THEN CANTIDAD ELSE 0 END D46,
CASE DIA WHEN 47 THEN CANTIDAD ELSE 0 END D47,
CASE DIA WHEN 48 THEN CANTIDAD ELSE 0 END D48,
CASE DIA WHEN 49 THEN CANTIDAD ELSE 0 END D49,
CASE DIA WHEN 50 THEN CANTIDAD ELSE 0 END D50,
CASE DIA WHEN 51 THEN CANTIDAD ELSE 0 END D51,
CASE DIA WHEN 52 THEN CANTIDAD ELSE 0 END D52,
CASE DIA WHEN 53 THEN CANTIDAD ELSE 0 END D53,
CASE DIA WHEN 54 THEN CANTIDAD ELSE 0 END D54,
CASE DIA WHEN 55 THEN CANTIDAD ELSE 0 END D55,
CASE DIA WHEN 56 THEN CANTIDAD ELSE 0 END D56,
CASE DIA WHEN 57 THEN CANTIDAD ELSE 0 END D57,
CASE DIA WHEN 58 THEN CANTIDAD ELSE 0 END D58,
CASE DIA WHEN 59 THEN CANTIDAD ELSE 0 END D59,
CASE DIA WHEN 60 THEN CANTIDAD ELSE 0 END D60,
CASE DIA WHEN 61 THEN CANTIDAD ELSE 0 END D61,
CASE DIA WHEN 62 THEN CANTIDAD ELSE 0 END D62,
CASE DIA WHEN 63 THEN CANTIDAD ELSE 0 END D63,
CASE DIA WHEN 64 THEN CANTIDAD ELSE 0 END D64,
CASE DIA WHEN 65 THEN CANTIDAD ELSE 0 END D65,
CASE DIA WHEN 66 THEN CANTIDAD ELSE 0 END D66,
CASE DIA WHEN 67 THEN CANTIDAD ELSE 0 END D67,
CASE DIA WHEN 68 THEN CANTIDAD ELSE 0 END D68,
CASE DIA WHEN 69 THEN CANTIDAD ELSE 0 END D69,
CASE DIA WHEN 70 THEN CANTIDAD ELSE 0 END D70
FROM (
SELECT B.IDARTICULO,C.DESCRIPCION,CONVERT(INT,B.CANTIDAD)CANTIDAD,DATEDIFF(DAY,D.FECHA,A.FECHACONF)DIA
FROM IMOV A INNER JOIN IMOVH B ON A.CNSMOV=B.CNSMOV
            INNER JOIN IART  C ON B.IDARTICULO=C.IDARTICULO
            INNER JOIN HADM  D ON A.NODOCUMENTO=D.NOADMISION
WHERE A.NODOCUMENTO=@NOADMISION AND C.IDITAR IN('01','02') AND  B.ESTADO=1) A)B
GROUP BY B.IDARTICULO,B.DESCRIPCION


END
IF @NUMER>=71 AND @NUMER<=80
BEGIN
PRINT 'BLOQUE 7'

INSERT INTO PERFAR(	IDARTICULO,DESCRIPCION,	D00,  
	D01,	D02,	D03,	D04,	D05,	D06,	D07,	D08,	D09,  D10,
	D11,	D12,	D13,	D14,	D15,	D16,  D17,  D18,  D19,  D20,
	D21,	D22,	D23,	D24,	D25,	D26,	D27,	D28,	D29,	D30,
	D31,	D32,	D33,	D34,	D35,	D36,	D37,	D38,	D39,	D40,
	D41,	D42,	D43,	D44,	D45,	D46,	D47,	D48,	D49,	D50,
	D51,	D52,	D53,	D54,	D55,	D56,	D57,	D58,	D59,	D60,
	D61,	D62,	D63,	D64,	D65,	D66,	D67,	D68,	D69,	D70,
	D71,	D72,	D73,	D74,	D75,	D76,	D77,	D78,	D79,	D80,TOTAL)

SELECT B.IDARTICULO,B.DESCRIPCION,
SUM(B.D00)D00,SUM(B.D01)D01,SUM(B.D02)D02,SUM(B.D03)D03,SUM(B.D04)D04,SUM(B.D05)D05,
SUM(B.D06)D06,SUM(B.D07)D07,SUM(B.D08)D08,SUM(B.D09)D09,SUM(B.D10)D10,
SUM(B.D11)D11,SUM(B.D12)D12,SUM(B.D13)D13,SUM(B.D14)D14,SUM(B.D15)D15,
SUM(B.D16)D16,SUM(B.D17)D17,SUM(B.D18)D18,SUM(B.D19)D19,SUM(B.D20)D20,
SUM(B.D21)D21,SUM(B.D22)D22,SUM(B.D23)D23,SUM(B.D24)D24,SUM(B.D25)D25,
SUM(B.D26)D26,SUM(B.D27)D27,SUM(B.D28)D28,SUM(B.D29)D29,SUM(B.D30)D30,
SUM(B.D31)D31,SUM(B.D32)D32,SUM(B.D33)D33,SUM(B.D34)D34,SUM(B.D35)D35,
SUM(B.D36)D36,SUM(B.D37)D37,SUM(B.D38)D38,SUM(B.D39)D39,SUM(B.D40)D40,
SUM(B.D41)D41,SUM(B.D42)D42,SUM(B.D43)D43,SUM(B.D44)D44,SUM(B.D45)D45,
SUM(B.D46)D46,SUM(B.D47)D47,SUM(B.D48)D48,SUM(B.D49)D49,SUM(B.D50)D50,
SUM(B.D51)D51,SUM(B.D52)D52,SUM(B.D53)D53,SUM(B.D54)D54,SUM(B.D55)D55,
SUM(B.D56)D56,SUM(B.D57)D57,SUM(B.D58)D58,SUM(B.D59)D59,SUM(B.D60)D60,
SUM(B.D61)D61,SUM(B.D62)D62,SUM(B.D63)D63,SUM(B.D64)D64,SUM(B.D65)D65,
SUM(B.D66)D66,SUM(B.D67)D67,SUM(B.D68)D68,SUM(B.D69)D69,SUM(B.D70)D70,
SUM(B.D71)D71,SUM(B.D72)D72,SUM(B.D73)D73,SUM(B.D74)D74,SUM(B.D75)D75,
SUM(B.D76)D76,SUM(B.D77)D77,SUM(B.D78)D78,SUM(B.D79)D79,SUM(B.D80)D80,
(SUM(B.D00)+SUM(B.D01)+SUM(B.D02)+SUM(B.D03)+SUM(B.D04)+SUM(B.D05)+SUM(B.D06)+SUM(B.D07)+SUM(B.D08)+SUM(B.D09)+SUM(B.D10)+
SUM(B.D11)+SUM(B.D12)+SUM(B.D13)+SUM(B.D14)+SUM(B.D15)+SUM(B.D16)+SUM(B.D17)+SUM(B.D18)+SUM(B.D19)+SUM(B.D20)+
SUM(B.D21)+SUM(B.D22)+SUM(B.D23)+SUM(B.D24)+SUM(B.D25)+SUM(B.D26)+SUM(B.D27)+SUM(B.D28)+SUM(B.D29)+SUM(B.D30)+
SUM(B.D31)+SUM(B.D32)+SUM(B.D33)+SUM(B.D34)+SUM(B.D35)+SUM(B.D36)+SUM(B.D37)+SUM(B.D38)+SUM(B.D39)+SUM(B.D40)+
SUM(B.D41)+SUM(B.D42)+SUM(B.D43)+SUM(B.D44)+SUM(B.D45)+SUM(B.D46)+SUM(B.D47)+SUM(B.D48)+SUM(B.D49)+SUM(B.D50)+
SUM(B.D51)+SUM(B.D52)+SUM(B.D53)+SUM(B.D54)+SUM(B.D55)+SUM(B.D56)+SUM(B.D57)+SUM(B.D58)+SUM(B.D59)+SUM(B.D60)+
SUM(B.D61)+SUM(B.D62)+SUM(B.D63)+SUM(B.D64)+SUM(B.D65)+SUM(B.D66)+SUM(B.D67)+SUM(B.D68)+SUM(B.D69)+SUM(B.D70)+
SUM(B.D71)+SUM(B.D72)+SUM(B.D73)+SUM(B.D74)+SUM(B.D75)+SUM(B.D76)+SUM(B.D77)+SUM(B.D78)+SUM(B.D79)+SUM(B.D80)
)TOTAL
FROM (
SELECT A.IDARTICULO,A.DESCRIPCION,
CASE DIA WHEN 0 THEN CANTIDAD ELSE 0 END D00,
CASE DIA WHEN 1 THEN CANTIDAD ELSE 0 END D01,
CASE DIA WHEN 2 THEN CANTIDAD ELSE 0 END D02,
CASE DIA WHEN 3 THEN CANTIDAD ELSE 0 END D03,
CASE DIA WHEN 4 THEN CANTIDAD ELSE 0 END D04,
CASE DIA WHEN 5 THEN CANTIDAD ELSE 0 END D05,
CASE DIA WHEN 6 THEN CANTIDAD ELSE 0 END D06,
CASE DIA WHEN 7 THEN CANTIDAD ELSE 0 END D07,
CASE DIA WHEN 8 THEN CANTIDAD ELSE 0 END D08,
CASE DIA WHEN 9 THEN CANTIDAD ELSE 0 END D09,
CASE DIA WHEN 10 THEN CANTIDAD ELSE 0 END D10,
CASE DIA WHEN 11 THEN CANTIDAD ELSE 0 END D11,
CASE DIA WHEN 12 THEN CANTIDAD ELSE 0 END D12,
CASE DIA WHEN 13 THEN CANTIDAD ELSE 0 END D13,
CASE DIA WHEN 14 THEN CANTIDAD ELSE 0 END D14,
CASE DIA WHEN 15 THEN CANTIDAD ELSE 0 END D15,
CASE DIA WHEN 16 THEN CANTIDAD ELSE 0 END D16,
CASE DIA WHEN 17 THEN CANTIDAD ELSE 0 END D17,
CASE DIA WHEN 18 THEN CANTIDAD ELSE 0 END D18,
CASE DIA WHEN 19 THEN CANTIDAD ELSE 0 END D19,
CASE DIA WHEN 20 THEN CANTIDAD ELSE 0 END D20,
CASE DIA WHEN 21 THEN CANTIDAD ELSE 0 END D21,
CASE DIA WHEN 22 THEN CANTIDAD ELSE 0 END D22,
CASE DIA WHEN 23 THEN CANTIDAD ELSE 0 END D23,
CASE DIA WHEN 24 THEN CANTIDAD ELSE 0 END D24,
CASE DIA WHEN 25 THEN CANTIDAD ELSE 0 END D25,
CASE DIA WHEN 26 THEN CANTIDAD ELSE 0 END D26,
CASE DIA WHEN 27 THEN CANTIDAD ELSE 0 END D27,
CASE DIA WHEN 28 THEN CANTIDAD ELSE 0 END D28,
CASE DIA WHEN 29 THEN CANTIDAD ELSE 0 END D29,
CASE DIA WHEN 30 THEN CANTIDAD ELSE 0 END D30,
CASE DIA WHEN 31 THEN CANTIDAD ELSE 0 END D31,
CASE DIA WHEN 32 THEN CANTIDAD ELSE 0 END D32,
CASE DIA WHEN 33 THEN CANTIDAD ELSE 0 END D33,
CASE DIA WHEN 34 THEN CANTIDAD ELSE 0 END D34,
CASE DIA WHEN 35 THEN CANTIDAD ELSE 0 END D35,
CASE DIA WHEN 36 THEN CANTIDAD ELSE 0 END D36,
CASE DIA WHEN 37 THEN CANTIDAD ELSE 0 END D37,
CASE DIA WHEN 38 THEN CANTIDAD ELSE 0 END D38,
CASE DIA WHEN 39 THEN CANTIDAD ELSE 0 END D39,
CASE DIA WHEN 40 THEN CANTIDAD ELSE 0 END D40,
CASE DIA WHEN 41 THEN CANTIDAD ELSE 0 END D41,
CASE DIA WHEN 42 THEN CANTIDAD ELSE 0 END D42,
CASE DIA WHEN 43 THEN CANTIDAD ELSE 0 END D43,
CASE DIA WHEN 44 THEN CANTIDAD ELSE 0 END D44,
CASE DIA WHEN 45 THEN CANTIDAD ELSE 0 END D45,
CASE DIA WHEN 46 THEN CANTIDAD ELSE 0 END D46,
CASE DIA WHEN 47 THEN CANTIDAD ELSE 0 END D47,
CASE DIA WHEN 48 THEN CANTIDAD ELSE 0 END D48,
CASE DIA WHEN 49 THEN CANTIDAD ELSE 0 END D49,
CASE DIA WHEN 50 THEN CANTIDAD ELSE 0 END D50,
CASE DIA WHEN 51 THEN CANTIDAD ELSE 0 END D51,
CASE DIA WHEN 52 THEN CANTIDAD ELSE 0 END D52,
CASE DIA WHEN 53 THEN CANTIDAD ELSE 0 END D53,
CASE DIA WHEN 54 THEN CANTIDAD ELSE 0 END D54,
CASE DIA WHEN 55 THEN CANTIDAD ELSE 0 END D55,
CASE DIA WHEN 56 THEN CANTIDAD ELSE 0 END D56,
CASE DIA WHEN 57 THEN CANTIDAD ELSE 0 END D57,
CASE DIA WHEN 58 THEN CANTIDAD ELSE 0 END D58,
CASE DIA WHEN 59 THEN CANTIDAD ELSE 0 END D59,
CASE DIA WHEN 60 THEN CANTIDAD ELSE 0 END D60,
CASE DIA WHEN 61 THEN CANTIDAD ELSE 0 END D61,
CASE DIA WHEN 62 THEN CANTIDAD ELSE 0 END D62,
CASE DIA WHEN 63 THEN CANTIDAD ELSE 0 END D63,
CASE DIA WHEN 64 THEN CANTIDAD ELSE 0 END D64,
CASE DIA WHEN 65 THEN CANTIDAD ELSE 0 END D65,
CASE DIA WHEN 66 THEN CANTIDAD ELSE 0 END D66,
CASE DIA WHEN 67 THEN CANTIDAD ELSE 0 END D67,
CASE DIA WHEN 68 THEN CANTIDAD ELSE 0 END D68,
CASE DIA WHEN 69 THEN CANTIDAD ELSE 0 END D69,
CASE DIA WHEN 70 THEN CANTIDAD ELSE 0 END D70,
CASE DIA WHEN 71 THEN CANTIDAD ELSE 0 END D71,
CASE DIA WHEN 72 THEN CANTIDAD ELSE 0 END D72,
CASE DIA WHEN 73 THEN CANTIDAD ELSE 0 END D73,
CASE DIA WHEN 74 THEN CANTIDAD ELSE 0 END D74,
CASE DIA WHEN 75 THEN CANTIDAD ELSE 0 END D75,
CASE DIA WHEN 76 THEN CANTIDAD ELSE 0 END D76,
CASE DIA WHEN 77 THEN CANTIDAD ELSE 0 END D77,
CASE DIA WHEN 78 THEN CANTIDAD ELSE 0 END D78,
CASE DIA WHEN 79 THEN CANTIDAD ELSE 0 END D79,
CASE DIA WHEN 80 THEN CANTIDAD ELSE 0 END D80
FROM (
SELECT B.IDARTICULO,C.DESCRIPCION,CONVERT(INT,B.CANTIDAD)CANTIDAD,DATEDIFF(DAY,D.FECHA,A.FECHACONF)DIA
FROM IMOV A INNER JOIN IMOVH B ON A.CNSMOV=B.CNSMOV
            INNER JOIN IART  C ON B.IDARTICULO=C.IDARTICULO
            INNER JOIN HADM  D ON A.NODOCUMENTO=D.NOADMISION
WHERE A.NODOCUMENTO=@NOADMISION AND C.IDITAR IN('01','02') AND  B.ESTADO=1) A)B
GROUP BY B.IDARTICULO,B.DESCRIPCION


END
IF @NUMER>=81 AND @NUMER<=90
BEGIN
PRINT 'BLOQUE 8'

INSERT INTO PERFAR(IDARTICULO,DESCRIPCION,	D00,  
	D01,	D02,	D03,	D04,	D05,	D06,	D07,	D08,	D09,  D10,
	D11,	D12,	D13,	D14,	D15,	D16,  D17,  D18,  D19,  D20,
	D21,	D22,	D23,	D24,	D25,	D26,	D27,	D28,	D29,	D30,
	D31,	D32,	D33,	D34,	D35,	D36,	D37,	D38,	D39,	D40,
	D41,	D42,	D43,	D44,	D45,	D46,	D47,	D48,	D49,	D50,
	D51,	D52,	D53,	D54,	D55,	D56,	D57,	D58,	D59,	D60,
	D61,	D62,	D63,	D64,	D65,	D66,	D67,	D68,	D69,	D70,
	D71,	D72,	D73,	D74,	D75,	D76,	D77,	D78,	D79,	D80,
	D81,	D82,	D83,	D84,	D85,	D86,	D87,	D88,	D89,	D90,TOTAL)

SELECT B.IDARTICULO,B.DESCRIPCION,
SUM(B.D00)D00,SUM(B.D01)D01,SUM(B.D02)D02,SUM(B.D03)D03,SUM(B.D04)D04,SUM(B.D05)D05,
SUM(B.D06)D06,SUM(B.D07)D07,SUM(B.D08)D08,SUM(B.D09)D09,SUM(B.D10)D10,
SUM(B.D11)D11,SUM(B.D12)D12,SUM(B.D13)D13,SUM(B.D14)D14,SUM(B.D15)D15,
SUM(B.D16)D16,SUM(B.D17)D17,SUM(B.D18)D18,SUM(B.D19)D19,SUM(B.D20)D20,
SUM(B.D21)D21,SUM(B.D22)D22,SUM(B.D23)D23,SUM(B.D24)D24,SUM(B.D25)D25,
SUM(B.D26)D26,SUM(B.D27)D27,SUM(B.D28)D28,SUM(B.D29)D29,SUM(B.D30)D30,
SUM(B.D31)D31,SUM(B.D32)D32,SUM(B.D33)D33,SUM(B.D34)D34,SUM(B.D35)D35,
SUM(B.D36)D36,SUM(B.D37)D37,SUM(B.D38)D38,SUM(B.D39)D39,SUM(B.D40)D40,
SUM(B.D41)D41,SUM(B.D42)D42,SUM(B.D43)D43,SUM(B.D44)D44,SUM(B.D45)D45,
SUM(B.D46)D46,SUM(B.D47)D47,SUM(B.D48)D48,SUM(B.D49)D49,SUM(B.D50)D50,
SUM(B.D51)D51,SUM(B.D52)D52,SUM(B.D53)D53,SUM(B.D54)D54,SUM(B.D55)D55,
SUM(B.D56)D56,SUM(B.D57)D57,SUM(B.D58)D58,SUM(B.D59)D59,SUM(B.D60)D60,
SUM(B.D61)D61,SUM(B.D62)D62,SUM(B.D63)D63,SUM(B.D64)D64,SUM(B.D65)D65,
SUM(B.D66)D66,SUM(B.D67)D67,SUM(B.D68)D68,SUM(B.D69)D69,SUM(B.D70)D70,
SUM(B.D71)D71,SUM(B.D72)D72,SUM(B.D73)D73,SUM(B.D74)D74,SUM(B.D75)D75,
SUM(B.D76)D76,SUM(B.D77)D77,SUM(B.D78)D78,SUM(B.D79)D79,SUM(B.D80)D80,
SUM(B.D81)D81,SUM(B.D82)D82,SUM(B.D83)D83,SUM(B.D84)D84,SUM(B.D85)D85,
SUM(B.D86)D86,SUM(B.D87)D87,SUM(B.D88)D88,SUM(B.D89)D89,SUM(B.D90)D90,
(SUM(B.D00)+SUM(B.D01)+SUM(B.D02)+SUM(B.D03)+SUM(B.D04)+SUM(B.D05)+SUM(B.D06)+SUM(B.D07)+SUM(B.D08)+SUM(B.D09)+SUM(B.D10)+
SUM(B.D11)+SUM(B.D12)+SUM(B.D13)+SUM(B.D14)+SUM(B.D15)+SUM(B.D16)+SUM(B.D17)+SUM(B.D18)+SUM(B.D19)+SUM(B.D20)+
SUM(B.D21)+SUM(B.D22)+SUM(B.D23)+SUM(B.D24)+SUM(B.D25)+SUM(B.D26)+SUM(B.D27)+SUM(B.D28)+SUM(B.D29)+SUM(B.D30)+
SUM(B.D31)+SUM(B.D32)+SUM(B.D33)+SUM(B.D34)+SUM(B.D35)+SUM(B.D36)+SUM(B.D37)+SUM(B.D38)+SUM(B.D39)+SUM(B.D40)+
SUM(B.D41)+SUM(B.D42)+SUM(B.D43)+SUM(B.D44)+SUM(B.D45)+SUM(B.D46)+SUM(B.D47)+SUM(B.D48)+SUM(B.D49)+SUM(B.D50)+
SUM(B.D51)+SUM(B.D52)+SUM(B.D53)+SUM(B.D54)+SUM(B.D55)+SUM(B.D56)+SUM(B.D57)+SUM(B.D58)+SUM(B.D59)+SUM(B.D60)+
SUM(B.D61)+SUM(B.D62)+SUM(B.D63)+SUM(B.D64)+SUM(B.D65)+SUM(B.D66)+SUM(B.D67)+SUM(B.D68)+SUM(B.D69)+SUM(B.D70)+
SUM(B.D71)+SUM(B.D72)+SUM(B.D73)+SUM(B.D74)+SUM(B.D75)+SUM(B.D76)+SUM(B.D77)+SUM(B.D78)+SUM(B.D79)+SUM(B.D80)+
SUM(B.D81)+SUM(B.D82)+SUM(B.D83)+SUM(B.D84)+SUM(B.D85)+SUM(B.D86)+SUM(B.D87)+SUM(B.D88)+SUM(B.D89)+SUM(B.D90)
)TOTAL 
FROM (
SELECT A.IDARTICULO,A.DESCRIPCION,
CASE DIA WHEN 0 THEN CANTIDAD ELSE 0 END D00,
CASE DIA WHEN 1 THEN CANTIDAD ELSE 0 END D01,
CASE DIA WHEN 2 THEN CANTIDAD ELSE 0 END D02,
CASE DIA WHEN 3 THEN CANTIDAD ELSE 0 END D03,
CASE DIA WHEN 4 THEN CANTIDAD ELSE 0 END D04,
CASE DIA WHEN 5 THEN CANTIDAD ELSE 0 END D05,
CASE DIA WHEN 6 THEN CANTIDAD ELSE 0 END D06,
CASE DIA WHEN 7 THEN CANTIDAD ELSE 0 END D07,
CASE DIA WHEN 8 THEN CANTIDAD ELSE 0 END D08,
CASE DIA WHEN 9 THEN CANTIDAD ELSE 0 END D09,
CASE DIA WHEN 10 THEN CANTIDAD ELSE 0 END D10,
CASE DIA WHEN 11 THEN CANTIDAD ELSE 0 END D11,
CASE DIA WHEN 12 THEN CANTIDAD ELSE 0 END D12,
CASE DIA WHEN 13 THEN CANTIDAD ELSE 0 END D13,
CASE DIA WHEN 14 THEN CANTIDAD ELSE 0 END D14,
CASE DIA WHEN 15 THEN CANTIDAD ELSE 0 END D15,
CASE DIA WHEN 16 THEN CANTIDAD ELSE 0 END D16,
CASE DIA WHEN 17 THEN CANTIDAD ELSE 0 END D17,
CASE DIA WHEN 18 THEN CANTIDAD ELSE 0 END D18,
CASE DIA WHEN 19 THEN CANTIDAD ELSE 0 END D19,
CASE DIA WHEN 20 THEN CANTIDAD ELSE 0 END D20,
CASE DIA WHEN 21 THEN CANTIDAD ELSE 0 END D21,
CASE DIA WHEN 22 THEN CANTIDAD ELSE 0 END D22,
CASE DIA WHEN 23 THEN CANTIDAD ELSE 0 END D23,
CASE DIA WHEN 24 THEN CANTIDAD ELSE 0 END D24,
CASE DIA WHEN 25 THEN CANTIDAD ELSE 0 END D25,
CASE DIA WHEN 26 THEN CANTIDAD ELSE 0 END D26,
CASE DIA WHEN 27 THEN CANTIDAD ELSE 0 END D27,
CASE DIA WHEN 28 THEN CANTIDAD ELSE 0 END D28,
CASE DIA WHEN 29 THEN CANTIDAD ELSE 0 END D29,
CASE DIA WHEN 30 THEN CANTIDAD ELSE 0 END D30,
CASE DIA WHEN 31 THEN CANTIDAD ELSE 0 END D31,
CASE DIA WHEN 32 THEN CANTIDAD ELSE 0 END D32,
CASE DIA WHEN 33 THEN CANTIDAD ELSE 0 END D33,
CASE DIA WHEN 34 THEN CANTIDAD ELSE 0 END D34,
CASE DIA WHEN 35 THEN CANTIDAD ELSE 0 END D35,
CASE DIA WHEN 36 THEN CANTIDAD ELSE 0 END D36,
CASE DIA WHEN 37 THEN CANTIDAD ELSE 0 END D37,
CASE DIA WHEN 38 THEN CANTIDAD ELSE 0 END D38,
CASE DIA WHEN 39 THEN CANTIDAD ELSE 0 END D39,
CASE DIA WHEN 40 THEN CANTIDAD ELSE 0 END D40,
CASE DIA WHEN 41 THEN CANTIDAD ELSE 0 END D41,
CASE DIA WHEN 42 THEN CANTIDAD ELSE 0 END D42,
CASE DIA WHEN 43 THEN CANTIDAD ELSE 0 END D43,
CASE DIA WHEN 44 THEN CANTIDAD ELSE 0 END D44,
CASE DIA WHEN 45 THEN CANTIDAD ELSE 0 END D45,
CASE DIA WHEN 46 THEN CANTIDAD ELSE 0 END D46,
CASE DIA WHEN 47 THEN CANTIDAD ELSE 0 END D47,
CASE DIA WHEN 48 THEN CANTIDAD ELSE 0 END D48,
CASE DIA WHEN 49 THEN CANTIDAD ELSE 0 END D49,
CASE DIA WHEN 50 THEN CANTIDAD ELSE 0 END D50,
CASE DIA WHEN 51 THEN CANTIDAD ELSE 0 END D51,
CASE DIA WHEN 52 THEN CANTIDAD ELSE 0 END D52,
CASE DIA WHEN 53 THEN CANTIDAD ELSE 0 END D53,
CASE DIA WHEN 54 THEN CANTIDAD ELSE 0 END D54,
CASE DIA WHEN 55 THEN CANTIDAD ELSE 0 END D55,
CASE DIA WHEN 56 THEN CANTIDAD ELSE 0 END D56,
CASE DIA WHEN 57 THEN CANTIDAD ELSE 0 END D57,
CASE DIA WHEN 58 THEN CANTIDAD ELSE 0 END D58,
CASE DIA WHEN 59 THEN CANTIDAD ELSE 0 END D59,
CASE DIA WHEN 60 THEN CANTIDAD ELSE 0 END D60,
CASE DIA WHEN 61 THEN CANTIDAD ELSE 0 END D61,
CASE DIA WHEN 62 THEN CANTIDAD ELSE 0 END D62,
CASE DIA WHEN 63 THEN CANTIDAD ELSE 0 END D63,
CASE DIA WHEN 64 THEN CANTIDAD ELSE 0 END D64,
CASE DIA WHEN 65 THEN CANTIDAD ELSE 0 END D65,
CASE DIA WHEN 66 THEN CANTIDAD ELSE 0 END D66,
CASE DIA WHEN 67 THEN CANTIDAD ELSE 0 END D67,
CASE DIA WHEN 68 THEN CANTIDAD ELSE 0 END D68,
CASE DIA WHEN 69 THEN CANTIDAD ELSE 0 END D69,
CASE DIA WHEN 70 THEN CANTIDAD ELSE 0 END D70,
CASE DIA WHEN 71 THEN CANTIDAD ELSE 0 END D71,
CASE DIA WHEN 72 THEN CANTIDAD ELSE 0 END D72,
CASE DIA WHEN 73 THEN CANTIDAD ELSE 0 END D73,
CASE DIA WHEN 74 THEN CANTIDAD ELSE 0 END D74,
CASE DIA WHEN 75 THEN CANTIDAD ELSE 0 END D75,
CASE DIA WHEN 76 THEN CANTIDAD ELSE 0 END D76,
CASE DIA WHEN 77 THEN CANTIDAD ELSE 0 END D77,
CASE DIA WHEN 78 THEN CANTIDAD ELSE 0 END D78,
CASE DIA WHEN 79 THEN CANTIDAD ELSE 0 END D79,
CASE DIA WHEN 80 THEN CANTIDAD ELSE 0 END D80,
CASE DIA WHEN 81 THEN CANTIDAD ELSE 0 END D81,
CASE DIA WHEN 82 THEN CANTIDAD ELSE 0 END D82,
CASE DIA WHEN 83 THEN CANTIDAD ELSE 0 END D83,
CASE DIA WHEN 84 THEN CANTIDAD ELSE 0 END D84,
CASE DIA WHEN 85 THEN CANTIDAD ELSE 0 END D85,
CASE DIA WHEN 86 THEN CANTIDAD ELSE 0 END D86,
CASE DIA WHEN 87 THEN CANTIDAD ELSE 0 END D87,
CASE DIA WHEN 88 THEN CANTIDAD ELSE 0 END D88,
CASE DIA WHEN 89 THEN CANTIDAD ELSE 0 END D89,
CASE DIA WHEN 90 THEN CANTIDAD ELSE 0 END D90
FROM (
SELECT B.IDARTICULO,C.DESCRIPCION,CONVERT(INT,B.CANTIDAD)CANTIDAD,DATEDIFF(DAY,D.FECHA,A.FECHACONF)DIA
FROM IMOV A INNER JOIN IMOVH B ON A.CNSMOV=B.CNSMOV
            INNER JOIN IART  C ON B.IDARTICULO=C.IDARTICULO
            INNER JOIN HADM  D ON A.NODOCUMENTO=D.NOADMISION
WHERE A.NODOCUMENTO=@NOADMISION AND C.IDITAR IN('01','02') AND  B.ESTADO=1) A)B
GROUP BY B.IDARTICULO,B.DESCRIPCION


END
END

SET NOCOUNT OFF
GO