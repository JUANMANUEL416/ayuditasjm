DECLARE 
@CNSPAGO           VARCHAR(16),
@NUMDOC            VARCHAR(20),
@CNSNIEPE			VARCHAR(20),
@USUARIO             VARCHAR(12),
@SYS_COMPUTERNAME    VARCHAR(254),
@COMPANIA            VARCHAR(2),
@SEDE                VARCHAR(5),
@NROCOMPROBANTE      VARCHAR(20),
@FECHACONT			 DATETIME,
@CUENTA INT =0
 


   DECLARE MCP_RECONSTRUYE CURSOR FOR
   SELECT A.CNSPAGO,A.NUMDOC,A.CNSNIEPE,A.USUARIO,A.SYS_COMPUTERNAME,A.COMPANIA,'01','','20140531'
   FROM NIEPE A 
   WHERE A.CNSPAGO='01201405P30-1'
   GROUP BY A.CNSPAGO,A.NUMDOC,A.CNSNIEPE,A.USUARIO,A.SYS_COMPUTERNAME,A.COMPANIA
   OPEN MCP_RECONSTRUYE    
   FETCH NEXT FROM MCP_RECONSTRUYE    
   INTO @CNSPAGO,@NUMDOC,@CNSNIEPE,@USUARIO,@SYS_COMPUTERNAME,@COMPANIA,@SEDE,@NROCOMPROBANTE,@FECHACONT
   WHILE @@FETCH_STATUS = 0    
   BEGIN
       PRINT 'EMPEZANDO....'+@CNSPAGO+' :: :: NUMDOC : : : :'+@NUMDOC
        EXEC SPK_CONTAB_NOMINA @CNSPAGO,@NUMDOC,@CNSNIEPE,@USUARIO,@SYS_COMPUTERNAME,@COMPANIA,@SEDE,@NROCOMPROBANTE,@FECHACONT
        SELECT @CUENTA=@CUENTA+1
        PRINT 'VOY EN EL NRO : : :'+STR(@CUENTA)
   FETCH NEXT FROM MCP_RECONSTRUYE    
   INTO @CNSPAGO,@NUMDOC,@CNSNIEPE,@USUARIO,@SYS_COMPUTERNAME,@COMPANIA,@SEDE,@NROCOMPROBANTE,@FECHACONT
   END
   CLOSE MCP_RECONSTRUYE
   DEALLOCATE MCP_RECONSTRUYE
   