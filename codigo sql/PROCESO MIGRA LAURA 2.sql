

SELECT DBO.FNK_COLUMNAS_TABLAS('LORDDM')

SELECT * FROM HBALI
SELECT * FROM HBALID
SELECT * FROM HBALIDD
SELECT * FROM HBALIDH

SELECT  * FROM IENF

SELECT  DISTINCT IDPLAN FROM AFI   WHERE NOT EXISTS(SELECT  * FROM PLN WHERE AFI.IDPLAN=PLN.IDPLAN)

SELECT  * FROM AFI WHERE IDPLAN='AMBUQ'


SELECT  * FROM IZSOL

UPDATE AFI SET IDPLAN


SELECT IDPLAN ,* FROM AFI WHERE NOT EXISTS(SELECT * FROM PLN WHERE AFI.IDPLAN=PLN.IDPLAN)

SELECT IDBODEGA, NOLOTE, IDARTICULO,COUNT(*) FROM IEXI
GROUP BY  IDBODEGA, NOLOTE, IDARTICULO
HAVING COUNT(*)>1

SELECT  * FROM HADM WHERE NOT EXISTS(SELECT * FROM AFI WHERE HADM.IDAFILIADO=AFI.IDAFILIADO)

DROP TABLE #A
SELECT DISTINCT CNSHBALI INTO #A FROM HBALI  WHERE FECHA<='01/01/2021'
SELECT  * FROM #A
DELETE HBALIDD 
FROM HBALIDD INNER JOIN #A ON HBALIDD.CNSHBALI=#A.CNSHBALI

DELETE HBALID 
FROM HBALID INNER JOIN #A ON HBALID.CNSHBALI=#A.CNSHBALI

DELETE HBALI 
FROM HBALI INNER JOIN #A ON HBALI.CNSHBALI=#A.CNSHBALI

SELECT * FROM #A


SELECT  * FROM IEXI WHERE EXISLOTE<=0 AND FECHAVENCE<='01/07/2022'

DELETE  IEXI WHERE EXISLOTE<=0 AND FECHAVENCE<='01/07/2022'


SELECT MIN(FECHASOL) FROM IZSOL

DROP TABLE #A


SELECT  DISTINCT CNSIZSOL INTO #A FROM IZSOL WHERE FECHASOL<'01/01/2022'

DELETE IZSOLDT
FROM IZSOLDT INNER JOIN IZSOLD ON IZSOLDT.CNSIZSOLD=IZSOLD.CNSIZSOLD
             INNER JOIN IZSOL  ON IZSOL.CNSIZSOL=IZSOLD.CNSIZSOL
             INNER JOIN #A     ON IZSOL.CNSIZSOL=#A.CNSIZSOL


DELETE IZSOLD
FROM IZSOLD  INNER JOIN IZSOL  ON IZSOL.CNSIZSOL=IZSOLD.CNSIZSOL
             INNER JOIN #A     ON IZSOL.CNSIZSOL=#A.CNSIZSOL


DELETE IZSOL
FROM IZSOL INNER JOIN #A     ON IZSOL.CNSIZSOL=#A.CNSIZSOL

SELECT  * FROM PXSE

SELECT  * FROM PXSN

DELETE PXS WHERE EXISTS(SELECT  * FROM PLN WHERE PXS.IDPLAN=PXS.IDPLAN AND ESTADO='Inactivo')

SELECT MIN(FECHA) FROM LING

SELECT TOP 10 * FROM LING

DROP TABLE #A

SELECT NOINGRESO INTO #A FROM LING WHERE FECHA<'01/01/2021'

SELECT
FROM LING INNER JOIN LORD ON LING.NOINGRESO=LORD.NOINGRESO
          INNER JOIN LORDD ON LORD.NORDEN=LORDD.NORDEN
          INNER JOIN LORDDM ON LORDD.NORDEN=LORDDM.NORDEN
          INNER JOIN #A ON LING.NOINGRESO=#A.NOINGRESO

DELETE LORDDM
FROM LING INNER JOIN LORD ON LING.NOINGRESO=LORD.NOINGRESO
          INNER JOIN LORDD ON LORD.NORDEN=LORDD.NORDEN
          INNER JOIN LORDDM ON LORDD.NORDEN=LORDDM.NORDEN
          INNER JOIN #A ON LING.NOINGRESO=#A.NOINGRESO


DELETE LORDD
FROM LING INNER JOIN LORD ON LING.NOINGRESO=LORD.NOINGRESO
          INNER JOIN LORDD ON LORD.NORDEN=LORDD.NORDEN
          INNER JOIN #A ON LING.NOINGRESO=#A.NOINGRESO


DELETE LORD
FROM LING INNER JOIN LORD ON LING.NOINGRESO=LORD.NOINGRESO
          INNER JOIN #A ON LING.NOINGRESO=#A.NOINGRESO

DELETE LING
FROM LING INNER JOIN #A ON LING.NOINGRESO=#A.NOINGRESO
