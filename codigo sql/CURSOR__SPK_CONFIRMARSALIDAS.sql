DECLARE 
		@IDBODEGA         VARCHAR(20),
		@CNSMOV           VARCHAR(20),
		@USUARIO          VARCHAR(12),
		@COMPANIA         VARCHAR(2),
		@SEDE             VARCHAR(5)


--SELECT IDBODEGA,CNSMOV,IDFUNCIONARIO,'01','01',SYS_cOMPUTERNAME 
--FROM IMOV  WHERE IDBODEGA='101' AND IDTIPOMOV='09' AND FECHAMOV<='20130208'

   DECLARE PG_CURSOR CURSOR FOR 
   SELECT   IDBODEGA,CNSMOV,IDFUNCIONARIO,'01','01' 
   FROM IMOV  WHERE IDBODEGA='101' AND IDTIPOMOV='SA' AND FECHAMOV<='20130209' AND ESTADO=0
   GROUP BY  IDBODEGA,CNSMOV,IDFUNCIONARIO   
   OPEN PG_CURSOR    
   FETCH NEXT FROM PG_CURSOR    
   INTO @IDBODEGA,@CNSMOV,@USUARIO,@COMPANIA,@SEDE
   WHILE @@FETCH_STATUS = 0    
   BEGIN 
		EXEC SPK_CONFIRMARSALIDAS  @IDBODEGA,@CNSMOV,@USUARIO,@COMPANIA,@SEDE
   FETCH NEXT FROM PG_CURSOR    
   INTO @IDBODEGA,@CNSMOV,@USUARIO,@COMPANIA,@SEDE
   END
   CLOSE PG_CURSOR
   DEALLOCATE PG_CURSOR


