USE PVIVIRBIEN

SELECT TOP 10 * FROM API_LOG WHERE USUARIO='KMONTES' ORDER BY ITEM DESC

SELECT  ID = ROW_NUMBER() OVER (ORDER BY IDAFILIADO, NOADMISION, NOPRESTACION, NOITEM),                                   IDAFILIADO,DOCIDAFILIADO,PACIENTE,PROCEDENCIA,NOADMISION,IDSERVICIO,DESCSERVICIO,FECHA,                                   CONVERT(DECIMAL(14,2),VALORTOTAL)VALORTOTAL,CONVERT(DECIMAL(14,2),VALORCOPAGO)VALORCOPAGO,                                   CONVERT(DECIMAL(14,2),VALOREXCEDENTE)VALOREXCEDENTE,
MARCAFAC,USUMARCA, NOPRESTACION, NOITEM,CNSFACT,COALESCE(NOAUTORIZACION,'')NOAUTORIZACION                                   ,IDTERCEROCA AS IDTERCERO,RAZONSOCIAL,IDPLAN,NOMPLAN AS DESCPLAN,CANTIDAD,TIPOCOPAGO,IDSEDE,CODUNG,N_FACTURA,VALOR                                   ,CAST(EXONERACION AS BIT)EXONERADO, VALORCOPAGO_EXONERA, TIPO_EXONERACION  
FROM [dbo].[VWK_CARGOS_HADMAUTCIT] WHERE (PROCEDENCIA LIKE '%%%%' OR PACIENTE LIKE '%%%%' OR DOCIDAFILIADO LIKE '%%%%' OR  NOADMISION LIKE '%%%%') AND 1=2  ORDER BY IDAFILIADO, NOADMISION, NOPRESTACION, NOITEM OFFSET (1-1)*10 ROWS  FETCH NEXT 10 ROWS ONLY 


SELECT NOCOBRABLE  * FROM AUTD


SELECT CIT.CONSECUTIVO,DBO.FNK_FECHA_GRINGA(CIT.FECHA)FECHA,CIT.IDAFILIADO,AFI.TIPO_DOC,AFI.DOCIDAFILIADO,AFI.NOMBREAFI,CIT.IDMEDICO,MED.NOMBRE,MES.DESCRIPCION,CIT.IDSERVICIO,SER.DESCSERVICIO,COALESCE(CIT.VALORTOTAL,0)VALORTOTAL,COALESCE(CIT.VALORCOPAGO,0)VALORCOPAGO,(COALESCE(CIT.VALORTOTAL,0)-COALESCE(CIT.VALORCOPAGO,0))VLR_EXCEDENTE,COALESCE(CIT.FACTURADA,0) FACTURADA,CIT.N_FACTURA,CIT.NFACTURA AS NBOLETA,TER.NIT,TER.RAZONSOCIAL,CIT.IDPLAN,PLN.DESCPLAN,COALESCE(PPT.PAQUETIZADO,0)PAQUETIZADO,CIT.IDTERCEROCA,(SELECT SUM((AUTD.VALOR*AUTD.CANTIDAD)) FROM AUTD INNER JOIN AUT ON AUTD.IDAUT=AUT.IDAUT WHERE AUT.CONSECUTIVOCIT=CIT.CONSECUTIVO AND COALESCE(AUTD.NOCOBRABLE,0)<>1) + COALESCE(CIT.VALORTOTAL,0) AS VALORSERVICIOS,(SELECT SUM(AUT.VALORCOPAGO) FROM AUT WHERE AUT.CONSECUTIVOCIT=CIT.CONSECUTIVO)+COALESCE(CIT.VALORCOPAGO,0) AS VALORCOPAGO,(SELECT SUM((AUTD.VALOR*AUTD.CANTIDAD))-SUM(AUT.VALORCOPAGO) FROM AUTD INNER JOIN AUT ON AUTD.IDAUT=AUT.IDAUT WHERE AUT.CONSECUTIVOCIT=CIT.CONSECUTIVO AND COALESCE(AUTD.NOCOBRABLE,0)<>1)+(COALESCE(CIT.VALORTOTAL,0)-COALESCE(CIT.VALORCOPAGO,0)) AS VLR_EXCEDENTE  FROM [dbo].[CIT] INNER JOIN  AFI ON CIT.IDAFILIADO=AFI.IDAFILIADO INNER JOIN  MED ON CIT.IDMEDICO=MED.IDMEDICO INNER JOIN  SER ON CIT.IDSERVICIO=SER.IDSERVICIO INNER JOIN TER ON CIT.IDTERCEROCA=TER.IDTERCERO INNER JOIN PLN ON CIT.IDPLAN=PLN.IDPLAN INNER JOIN PPT ON CIT.IDTERCEROCA=PPT.IDTERCERO AND CIT.IDPLAN=PPT.IDPLAN LEFT JOIN  MES ON CIT.IDEMEDICA=MES.IDEMEDICA WHERE (MED.NOMBRE LIKE '%%%%' OR CONSECUTIVO LIKE '%%%%' OR AFI.NOMBREAFI LIKE '%%%%') AND  COALESCE(CIT.CUMPLIDA,0)=1 AND CIT.IDAFILIADO IS NOT NULL  AND CONVERT(DATE,CIT.FECHA)>='2025-05-31' AND CONVERT(DATE,CIT.FECHA)<='2025-06-11'  ORDER BY CONSECUTIVO DESC  OFFSET (1-1)*10 ROWS  FETCH NEXT 10 ROWS ONLY 

SELECT * FROM FTRD WHERE N_FACTURA='VB5'