IF EXISTS(SELECT NAME FROM SYSOBJECTS WHERE NAME='VWK_PTOI_EJE' AND XTYPE='V')
BEGIN
   DROP VIEW VWK_PTOI_EJE
END

GO
CREATE VIEW DBO.VWK_PTOI_EJE
WITH ENCRYPTION
AS
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 1,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI01,
        VLR_TDB         = A.TDB01,
        VLR_TCR         = A.TCR01,
        VLR_ACU_MDB		= A.MDB01,
        VLR_ACU_MCR		= A.MCR01,
        VLR_MDB         = A.MDB01,
        VLR_MCR         = A.MCR01,
        VLR_FINAL       = A.SF01,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01-DISRECO01,
        VLR_RECOA_ACU   = A.RECO01 -DISRECO01,
        VLR_RECOR_ACU   = A.RECOA01+RECOR01,
        VLR_RECO_MES    = A.RECO01-DISRECO01,
        VLR_RECOA_MES   = A.RECOA01,
        VLR_RECOR_MES   = A.RECOR01,
        VLR_RECO_TOT    = A.RECO01+A.RECOA01+RECOR01-DISRECO01,
        VLR_RECO_POR    = CASE WHEN A.SF01 = 0 THEN 0 ELSE ((A.RECO01+A.RECOA01+RECOR01-DISRECO01)*100)/A.SF01 END,
        VLR_RECA_ACU    = A.RECA01+A.RECAA01+RECAR01,
        VLR_RECAA_ACU   = A.RECA01,
        VLR_RECAR_ACU   = A.RECAA01+RECAR01,
        VLR_RECA_MES    = A.RECA01,
        VLR_RECAA_MES   = A.RECAA01,
        VLR_RECAR_MES   = A.RECAR01,
        VLR_RECA_TOT    = A.RECA01+A.RECAA01+RECAR01,
        VLR_RECA_POR    = CASE WHEN A.RECO01+A.RECAA01+RECAR01 = 0 THEN 0 ELSE ((A.RECA01+A.RECAA01+RECAR01)*100)/CASE WHEN A.SF01>0 THEN A.SF01 ELSE 1 END END,
        VLR_APROPIACION = (A.SF01+A.DISRECO01) -(A.RECO01+A.RECOA01+RECOR01-A.DISRECO01),
        VLR_PORCOBRAR   = (A.RECO01+A.RECOA01+RECOR01-DISRECO01) -( A.RECA01+A.RECAA01+RECAR01),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 2,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI02,
        VLR_TDB         = A.TDB02,
        VLR_TCR         = A.TCR02,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02,        
        VLR_MDB         = A.MDB02,
        VLR_MCR         = A.MCR02,
        VLR_FINAL       = A.SF02,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01-DISRECO01,
        VLR_RECOA_ACU   = A.RECO01 +A.RECO02 -(DISRECO01+DISRECO02),
        VLR_RECOR_ACU   = A.RECOA01+RECOR01+A.RECOA02+RECOR02,
        VLR_RECO_MES    = A.RECO02-DISRECO02,
        VLR_RECOA_MES   = A.RECOA02,
        VLR_RECOR_MES   = A.RECOR02,
        VLR_RECO_TOT    = (A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02) -(DISRECO01+DISRECO02),
        VLR_RECO_POR    = CASE WHEN A.SF02 = 0 THEN 0 ELSE (((A.RECO01 + A.RECO02)-(DISRECO01+DISRECO02)) *100)/CASE WHEN A.SF02>0 THEN A.SF02 ELSE 1 END END,
        VLR_RECA_ACU    = A.RECA01+A.RECA02+A.RECAA01+RECAR01+RECAA02+RECAR02,
        VLR_RECAA_ACU   = A.RECA01+A.RECA02,
        VLR_RECAR_ACU   = A.RECAA01+RECAR01+RECAA02+RECAR02,
        VLR_RECA_MES    = A.RECA02,
        VLR_RECAA_MES   = A.RECAA02,
        VLR_RECAR_MES   = A.RECAR02,
        VLR_RECA_TOT    = A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02)*100)/(A.RECO01 + A.RECO02) END,
        VLR_APROPIACION = (SF02+DISRECO02) -((RECO01+RECO02)-(DISRECO01+DISRECO02)),--(A.SF02+A.DISRECO01+DISRECO02) -((A.RECO01-DISRECO01)+(A.RECO02-DISRECO02)),
        VLR_PORCOBRAR   = (A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02) -(DISRECO01+DISRECO02) -( A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 3,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI03,
        VLR_TDB         = A.TDB03,
        VLR_TCR         = A.TCR03,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03,         
        VLR_MDB         = A.MDB03,
        VLR_MCR         = A.MCR03,
        VLR_FINAL       = A.SF03,
        VLR_RECO_ACU    = A.RECO01+ RECOA01+RECOR01 + A.RECO02+RECOA02+RECOR02-(DISRECO01+DISRECO02),
        VLR_RECOA_ACU   = A.RECO01 + A.RECO02 +RECO03-(DISRECO01+DISRECO02+DISRECO03),
        VLR_RECOR_ACU   = A.RECOA01 +RECOR01+ A.RECOA02+RECOR02+A.RECOA03+A.RECOR03,
        VLR_RECO_MES    = A.RECO03-DISRECO03,
        VLR_RECOA_MES   = A.RECOA03,
        VLR_RECOR_MES   = A.RECOR03,
        VLR_RECO_TOT    = (A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03) -(DISRECO01+DISRECO02+DISRECO03),
        VLR_RECO_POR    = CASE WHEN A.SF03 = 0 THEN 0 ELSE (((A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03) -(DISRECO01+DISRECO02+DISRECO03))*100)/CASE WHEN A.SF03>0 THEN A.SF03 ELSE 1 END END,
        VLR_RECA_ACU    = A.RECA01 + A.RECA02+RECA03+A.RECAR01+ RECAA01+RECAA02+A.RECAR02,
        VLR_RECAA_ACU   = A.RECA01 + A.RECA02+RECA03,
        VLR_RECAR_ACU   = A.RECAR01+ RECAA01+RECAA02+A.RECAR02+RECAR03+RECAA03,
        VLR_RECA_MES    = A.RECA03,
        VLR_RECAA_MES   = A.RECAA03,
        VLR_RECAR_MES   = A.RECAR03,
        VLR_RECA_TOT    = A.RECA01 + A.RECA02+RECA03+A.RECAR01+ RECAA01+RECAA02+A.RECAR02+RECAR03+RECAA03,
        VLR_RECA_POR    = CASE WHEN  A.RECA01 + A.RECA02+RECA03+A.RECAR01+ RECAA01+RECAA02+A.RECAR02+RECAR03+RECA03 = 0 THEN 0 
                           ELSE (( A.RECA01 + A.RECA02+RECA03+A.RECAR01+ RECAA01+RECAA02+A.RECAR02+RECAR03+RECA03)*100)/((A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03) -(DISRECO01+DISRECO02+DISRECO03)) END,
        VLR_APROPIACION =  (SF03+DISRECO03) -((A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03) -(DISRECO01+DISRECO02+DISRECO03)),
        VLR_PORCOBRAR   =(A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02+ A.RECO03 + A.RECOA03+RECOR03) -
						 (DISRECO01+DISRECO02+DISRECO03) -
						 ( A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 4,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI04,
        VLR_TDB         = A.TDB04,
        VLR_TCR         = A.TCR04,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03+A.MDB04,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03+A.MCR04,                 
        VLR_MDB         = A.MDB04,
        VLR_MCR         = A.MCR04,
        VLR_FINAL       = A.SF04,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03
                          -(DISRECO01+DISRECO02+DISRECO03+DISRECO04),
        VLR_RECOA_ACU   = A.RECO01 + A.RECO02 + A.RECO03+RECO04-(DISRECO01+DISRECO02+DISRECO03+DISRECO04),
        VLR_RECOR_ACU   = A.RECOA01 + RECOR01 + A.RECOA02 +A.RECOR02+ A.RECOA03+A.RECOR03+RECOR04+RECOA04,
        VLR_RECO_MES    = A.RECO04-DISRECO04,
        VLR_RECOA_MES   = A.RECOA04,
        VLR_RECOR_MES   = A.RECOR04,
        VLR_RECO_TOT    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03 + A.RECO04 + RECOA04+RECOR04
                          -(DISRECO01+DISRECO02+DISRECO03+DISRECO04),
        VLR_RECO_POR    = CASE WHEN A.SF04 = 0 THEN 0 ELSE (((A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03) -(DISRECO01+DISRECO02+DISRECO03))*100)/A.SF04 END,
        VLR_RECA_ACU    = A.RECA01 + A.RECA02+RECA03+A.RECAR01+ RECAA01+RECAA02+A.RECAR02+RECAA03+A.RECAR03,
        VLR_RECAA_ACU   = A.RECA01 + A.RECA02 + A.RECA03+RECA04,
        VLR_RECAR_ACU   = A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04,
        VLR_RECA_MES    = A.RECA04,
        VLR_RECAA_MES   = A.RECAA04,
        VLR_RECAR_MES   = A.RECAR04,
        VLR_RECA_TOT    = A.RECAR01+ RECAA01+RECAA02+A.RECAR02+RECAR03+RECA03+A.RECA01 + A.RECA02+RECAA03 + A.RECA04 +RECAA04+RECAR04,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04)*100)/(A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04) END,
        VLR_APROPIACION = (SF04+DISRECO04) -((RECO01+RECO02+RECO03+RECO04)-(DISRECO01+DISRECO02+DISRECO03+DISRECO04)),
        VLR_PORCOBRAR   =(A.RECO01+A.RECOA01+RECOR01+A.RECO02+A.RECOA02+RECOR02+A.RECO03+A.RECOA03+RECOR03+A.RECO04+A.RECOA04+RECOR04) -
						 (DISRECO01+DISRECO02+DISRECO03+DISRECO04) -
						 (A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03+A.RECA04+A.RECAA04+RECAR04),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 5,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI05,
        VLR_TDB         = A.TDB05,
        VLR_TCR         = A.TCR05,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03+A.MDB04+A.MDB05,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03+A.MCR04+A.MCR05,                         
        VLR_MDB         = A.MDB05,
        VLR_MCR         = A.MCR05,
        VLR_FINAL       = A.SF05,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03+A.RECO04+RECOR04+RECOA04 -(DISRECO01+DISRECO02+DISRECO03+DISRECO04),
        VLR_RECOA_ACU   = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04+RECO05 -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05),
        VLR_RECOR_ACU   = A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05,
        VLR_RECO_MES    = A.RECO05 - DISRECO05,
        VLR_RECOA_MES   = A.RECOA05 ,
        VLR_RECOR_MES   = A.RECOR05,
        VLR_RECO_TOT    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04+RECO05+A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05),
        VLR_RECO_POR    = CASE WHEN A.SF05 = 0 THEN 0 ELSE (((A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05)-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05))*100)/A.SF05 END,
        VLR_RECA_ACU    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04,
        VLR_RECAA_ACU   = A.RECA01 + A.RECA02 + A.RECA03+RECA04+RECA05,
        VLR_RECAR_ACU   = A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05,
        VLR_RECA_MES    = A.RECA05,
        VLR_RECAA_MES   = A.RECAA05,
        VLR_RECAR_MES   = A.RECAR05,
        VLR_RECA_TOT    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+RECA05+ A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05)*100)/(A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05) END,
        VLR_APROPIACION = (SF05+DISRECO05) -((RECO01+RECO02+RECO03+RECO04+RECO05)-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05)),
        VLR_PORCOBRAR   =(A.RECO01+A.RECOA01+RECOR01+A.RECO02+A.RECOA02+RECOR02+A.RECO03+A.RECOA03+RECOR03+A.RECO04+A.RECOA04+RECOR04+A.RECO05+A.RECOA05+RECOR05) -
						 (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05) -
						 (A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03+A.RECA04+A.RECAA04+RECAR04+A.RECA05+A.RECAA05+RECAR05),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 6,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI06,
        VLR_TDB         = A.TDB06,
        VLR_TCR         = A.TCR06,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03+A.MDB04+A.MDB05+A.MDB06,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03+A.MCR04+A.MCR05+A.MCR06,                                 
        VLR_MDB         = A.MDB06,
        VLR_MCR         = A.MCR06,
        VLR_FINAL       = A.SF06,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03+A.RECO04+RECOR04+RECOA04+A.RECO05+RECOR05+RECOA05-
                           (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05),
        VLR_RECOA_ACU   = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05+RECO06-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06),
        VLR_RECOR_ACU   = A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06,
        VLR_RECO_MES    = A.RECO06-DISRECO06,
        VLR_RECOA_MES   = A.RECOA06,
        VLR_RECOR_MES   = A.RECOR06,
        VLR_RECO_TOT    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06+ A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06 -
                          (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06),
        VLR_RECO_POR    = CASE WHEN A.SF06 = 0 THEN 0 ELSE (((A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06)))*100)/A.SF06 END,
        VLR_RECA_ACU    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECA05+RECAA05+RECAR05,
        VLR_RECAA_ACU    = A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05+RECA06,
        VLR_RECAR_ACU    = A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+RECAA06+RECAR06,
        VLR_RECA_MES    = A.RECA06,
        VLR_RECAA_MES    = A.RECAA06,
        VLR_RECAR_MES    = A.RECAR06,
        VLR_RECA_TOT    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+RECA05+RECA06+ A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+RECAA06+RECAR06,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06)*100)/(A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06) END,
        VLR_APROPIACION = (SF06+DISRECO06) -((RECO01+RECO02+RECO03+RECO04+RECO05+RECO06+RECOA01+RECOA02+RECOA03+RECOA04+RECOA05+RECOA06+RECOR01+RECOR02+RECOR03+RECOR04+RECOR05+RECOR06)-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06)),
        VLR_PORCOBRAR   =(A.RECO01+A.RECOA01+RECOR01+A.RECO02+A.RECOA02+RECOR02+A.RECO03+A.RECOA03+RECOR03+A.RECO04+A.RECOA04+RECOR04+A.RECO05+A.RECOA05+RECOR05 +
						  +A.RECO06+A.RECOA06+RECOR06) -
						 (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06) -
						 (A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03+A.RECA04+A.RECAA04+RECAR04+A.RECA05+A.RECAA05+RECAR05+
						 +A.RECA06+A.RECAA06+RECAR06),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 7,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI07,
        VLR_TDB         = A.TDB07,
        VLR_TCR         = A.TCR07,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03+A.MDB04+A.MDB05+A.MDB06+A.MDB07,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03+A.MCR04+A.MCR05+A.MCR06+A.MCR07,                                         
        VLR_MDB         = A.MDB07,
        VLR_MCR         = A.MCR07,
        VLR_FINAL       = A.SF07,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03+A.RECO04+RECOR04+RECOA04+A.RECO05+RECOR05+RECOA05+A.RECO06+RECOR06+RECOA06-
                           (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06),
        VLR_RECOA_ACU    =A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06),
        VLR_RECOR_ACU    =A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07,
        VLR_RECO_MES    = A.RECO07-DISRECO07,
        VLR_RECOA_MES   = A.RECOA07,
        VLR_RECOR_MES   = A.RECOR07,
        VLR_RECO_TOT    =  A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06+ A.RECO07+ A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07 -
                          (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07),
        VLR_RECO_POR    = CASE WHEN A.SF07 = 0 THEN 0 ELSE (((A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06+ A.RECO07-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07)))*100)/A.SF07 END,
        VLR_RECA_ACU    =  A.RECA01 + A.RECA02 + A.RECA03+RECA04+A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECA05+RECAA05+RECAR05+RECA06+RECAA06+RECAR06,
        VLR_RECAA_ACU    = A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05+RECA06+RECA07,
        VLR_RECAR_ACU    = A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+RECAA06+RECAR06+RECAA07+RECAR07,
        VLR_RECA_MES    = A.RECA07,
        VLR_RECAA_MES   = A.RECAA07,
        VLR_RECAR_MES   = A.RECAR07,
        VLR_RECA_TOT    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+RECA05+RECA06+RECA07+ A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+RECAA06+RECAR06+RECAA07+RECAR07,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07)*100)/(A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07) END,
        VLR_APROPIACION = (SF07+DISRECO07) -((RECO01+RECO02+RECO03+RECO04+RECO05+RECO06+RECO07+RECOA01+RECOA02+RECOA03+RECOA04+RECOA05+RECOA06+RECOA07+RECOR01+RECOR02+RECOR03+RECOR04+RECOR05+RECOR06+RECOR07)
                           -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07)),
        VLR_PORCOBRAR   =(A.RECO01+A.RECOA01+RECOR01+A.RECO02+A.RECOA02+RECOR02+A.RECO03+A.RECOA03+RECOR03+A.RECO04+A.RECOA04+RECOR04+A.RECO05+A.RECOA05+RECOR05 +
						  +A.RECO06+A.RECOA06+RECOR06+A.RECO07+A.RECOA07+RECOR07) -
						 (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07) -
						 (A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03+A.RECA04+A.RECAA04+RECAR04+A.RECA05+A.RECAA05+RECAR05+
						 +A.RECA06+A.RECAA06+RECAR06+A.RECA07+A.RECAA07+RECAR07),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 8,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI08,
        VLR_TDB         = A.TDB08,
        VLR_TCR         = A.TCR08,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03+A.MDB04+A.MDB05+A.MDB06+A.MDB07+A.MDB08,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03+A.MCR04+A.MCR05+A.MCR06+A.MCR07+A.MCR08,                                                 
        VLR_MDB         = A.MDB08,
        VLR_MCR         = A.MCR08,
        VLR_FINAL       = A.SF08,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03+A.RECO04+RECOR04+RECOA04+A.RECO05+RECOR05+RECOA05+A.RECO06+RECOR06+RECOA06+A.RECO07+RECOR07+RECOA07-
                           (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07),
        VLR_RECOA_ACU    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07+ A.RECO08-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07),
        VLR_RECOR_ACU    = A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+RECOA08+RECOR08,
        VLR_RECO_MES    = A.RECO08,
        VLR_RECOA_MES   = A.RECOA08,
        VLR_RECOR_MES   = A.RECOR08,
        VLR_RECO_TOT    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06+ A.RECO07+A.RECO08+ A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+RECOA08+RECOR08 -
                          (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08),
        VLR_RECO_POR    = CASE WHEN A.SF08 = 0 THEN 0 ELSE (((A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06+ A.RECO07+ A.RECO08-(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08)))*100)/A.SF08 END,
        VLR_RECA_ACU    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECA05+RECAA05+RECAR05+RECA06+RECAA06+RECAR06+RECA07+RECAA07+RECAR07,
        VLR_RECAA_ACU    = A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05+RECA06+RECA07+RECA08,
        VLR_RECAR_ACU    =  A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08,
        VLR_RECA_MES    = A.RECA08,
        VLR_RECAA_MES   = A.RECAA08,
        VLR_RECAR_MES   = A.RECAR08,
        VLR_RECA_TOT    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+RECA05+RECA06+RECA07+RECA08+ A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07 + A.RECA08)*100)/(A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08) END,
        VLR_APROPIACION = (SF08+DISRECO08) -((RECO01+RECO02+RECO03+RECO04+RECO05+RECO06+RECO07+RECO08+RECOA01+RECOA02+RECOA03+RECOA04+RECOA05+RECOA06+RECOA07+RECOA08+RECOR01+RECOR02+RECOR03+RECOR04+RECOR05+RECOR06+RECOR07+RECOR08)
                           -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08)),
        VLR_PORCOBRAR =(A.RECO01+A.RECOA01+RECOR01+A.RECO02+A.RECOA02+RECOR02+A.RECO03+A.RECOA03+RECOR03+A.RECO04+A.RECOA04+RECOR04+A.RECO05+A.RECOA05+RECOR05 +
						  +A.RECO06+A.RECOA06+RECOR06+A.RECO07+A.RECOA07+RECOR07+A.RECO08+A.RECOA08+RECOR08) -
						 (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08) -
						 (A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03+A.RECA04+A.RECAA04+RECAR04+A.RECA05+A.RECAA05+RECAR05+
						 +A.RECA06+A.RECAA06+RECAR06+A.RECA07+A.RECAA07+RECAR07+A.RECA08+A.RECAA08+RECAR08),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 9,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI09,
        VLR_TDB         = A.TDB09,
        VLR_TCR         = A.TCR09,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03+A.MDB04+A.MDB05+A.MDB06+A.MDB07+A.MDB08+A.MDB09,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03+A.MCR04+A.MCR05+A.MCR06+A.MCR07+A.MCR08+A.MCR09,                                                         
        VLR_MDB         = A.MDB09,
        VLR_MCR         = A.MCR09,
        VLR_FINAL       = A.SF09,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03+A.RECO04+RECOR04+RECOA04+A.RECO05+RECOR05+RECOA05+A.RECO06+RECOR06+RECOA06+
                          A.RECO07+RECOR07+RECOA07+A.RECO08+RECOR08+RECOA08-
                          (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08),
        VLR_RECOA_ACU    =A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07+ A.RECO08+ A.RECO09
                          -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO08+DISRECO09),
        VLR_RECOR_ACU   = A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+RECOA08+RECOR08+RECOA09+RECOR09,
        VLR_RECO_MES    = A.RECO09,
        VLR_RECOA_MES   = A.RECOA09,
        VLR_RECOR_MES   = A.RECOR09,
        VLR_RECO_TOT    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06+ A.RECO07+A.RECO08+A.RECO09+ A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+
                          A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+RECOA08+RECOR08+RECOA09+RECOR09 -
                          (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09),
        VLR_RECO_POR    = CASE WHEN A.SF09 = 0 THEN 0 ELSE ((A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09)*100)/A.SF09 END,
        VLR_RECA_ACU    =A.RECA01 + A.RECA02 + A.RECA03+RECA04+A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECA05+RECAA05+RECAR05+
                          RECA06+RECAA06+RECAR06+RECA07+RECAA07+RECAR07+RECA08+RECAA08+RECAR08,
        VLR_RECAA_ACU    = A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07 + A.RECA08+ A.RECA09,
        VLR_RECAR_ACU    = A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+
                           RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08+RECAA09+RECAR09,
        VLR_RECA_MES    = A.RECA09,
        VLR_RECAA_MES   = A.RECAA09,
        VLR_RECAR_MES   = A.RECAR09,
        VLR_RECA_TOT    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+RECA05+RECA06+RECA07+RECA08+RECA09+ A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+
                          RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08+RECAA09+RECAR09,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07 + A.RECA08 + A.RECA09)*100)/(A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09) END,
        VLR_APROPIACION =(SF09+DISRECO09) -((RECO01+RECO02+RECO03+RECO04+RECO05+RECO06+RECO07+RECO08+RECO09+RECOA01+RECOA02+RECOA03+RECOA04+RECOA05+RECOA06+RECOA07+RECOA08+RECOA09+RECOR01+RECOR02+RECOR03+RECOR04+RECOR05+RECOR06+RECOR07+RECOR08+RECOR09)
                         -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09)),
        VLR_PORCOBRAR   =(A.RECO01+A.RECOA01+RECOR01+A.RECO02+A.RECOA02+RECOR02+A.RECO03+A.RECOA03+RECOR03+A.RECO04+A.RECOA04+RECOR04+A.RECO05+A.RECOA05+RECOR05 +
						        +A.RECO06+A.RECOA06+RECOR06+A.RECO07+A.RECOA07+RECOR07+A.RECO08+A.RECOA08+RECOR08+A.RECO09+A.RECOA09+RECOR09) -
						       (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09) -
						       (A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03+A.RECA04+A.RECAA04+RECAR04+A.RECA05+A.RECAA05+RECAR05+
						       +A.RECA06+A.RECAA06+RECAR06+A.RECA07+A.RECAA07+RECAR07+A.RECA08+A.RECAA08+RECAR08+A.RECA09+A.RECAA09+RECAR09),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 10,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI10,
        VLR_TDB         = A.TDB10,
        VLR_TCR         = A.TCR10,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03+A.MDB04+A.MDB05+A.MDB06+A.MDB07+A.MDB08+A.MDB09+A.MDB10,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03+A.MCR04+A.MCR05+A.MCR06+A.MCR07+A.MCR08+A.MCR09+A.MCR10,                                                                
        VLR_MDB         = A.MDB10,
        VLR_MCR         = A.MCR10,
        VLR_FINAL       = A.SF10,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03+A.RECO04+RECOR04+RECOA04+A.RECO05+RECOR05+RECOA05+A.RECO06+RECOR06+RECOA06+
                          A.RECO07+RECOR07+RECOA07+A.RECO08+RECOR08+RECOA08+A.RECO09+RECOR09+RECOA09-
                          (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09),
        VLR_RECOA_ACU    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09+ A.RECO10
                           -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10),
        VLR_RECOR_ACU    = A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+
                           RECOA08+RECOR08+RECOA09+RECOR09+RECOA10+RECOR10,
        VLR_RECO_MES    = A.RECO10,
        VLR_RECOA_MES   = A.RECOA10,
        VLR_RECOR_MES   = A.RECOR10,
        VLR_RECO_TOT    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06+ A.RECO07+A.RECO08+A.RECO09+A.RECO10+ A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+
                          A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+RECOA08+RECOR08+RECOA09+RECOR09+RECOA10+RECOR10 -
                          (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10),
        VLR_RECO_POR    = CASE WHEN A.SF10 = 0 THEN 0 ELSE ((A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 + A.RECO10)*100)/A.SF10 END,
        VLR_RECA_ACU    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECA05+RECAA05+RECAR05+
                          RECA06+RECAA06+RECAR06+RECA07+RECAA07+RECAR07+RECA08+RECAA08+RECAR08+RECA09+RECAA09+RECAR09,
        VLR_RECAA_ACU    =A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07 + A.RECA08+ A.RECA09+ A.RECA10,
        VLR_RECAR_ACU    = A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+
                           RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08+RECAA09+RECAR09+RECAA10+RECAR10,
        VLR_RECA_MES    = A.RECA10,
        VLR_RECAA_MES    = A.RECAA10,
        VLR_RECAR_MES    = A.RECAR10,
        VLR_RECA_TOT    =A.RECA01 + A.RECA02 + A.RECA03+RECA04+RECA05+RECA06+RECA07+RECA08+RECA09+RECA10+ A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+
                          RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08+RECAA09+RECAR09+RECAA10+RECAR10,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 + A.RECO10 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07 + A.RECA08 + A.RECA09 + A.RECA10)*100)/(A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 + A.RECO10) END,
        VLR_APROPIACION = (SF10+DISRECO10) -((RECO01+RECO02+RECO03+RECO04+RECO05+RECO06+RECO07+RECO08+RECO09+RECO10+RECOA01+RECOA02+RECOA03+RECOA04+RECOA05+RECOA06+RECOA07+RECOA08+RECOA09+RECOA10
                           +RECOR01+RECOR02+RECOR03+RECOR04+RECOR05+RECOR06+RECOR07+RECOR08+RECOR09+RECOR10)
                          -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10)),
        VLR_PORCOBRAR   =(A.RECO01+A.RECOA01+RECOR01+A.RECO02+A.RECOA02+RECOR02+A.RECO03+A.RECOA03+RECOR03+A.RECO04+A.RECOA04+RECOR04+A.RECO05+A.RECOA05+RECOR05 +
						        +A.RECO06+A.RECOA06+RECOR06+A.RECO07+A.RECOA07+RECOR07+A.RECO08+A.RECOA08+RECOR08+A.RECO09+A.RECOA09+RECOR09+A.RECO10+A.RECOA10+RECOR10) -
						       (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10) -
						       (A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03+A.RECA04+A.RECAA04+RECAR04+A.RECA05+A.RECAA05+RECAR05+
						       +A.RECA06+A.RECAA06+RECAR06+A.RECA07+A.RECAA07+RECAR07+A.RECA08+A.RECAA08+RECAR08+A.RECA09+A.RECAA09+RECAR09+A.RECA10+A.RECAA10+RECAR10),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 11,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI11,
        VLR_TDB         = A.TDB11,
        VLR_TCR         = A.TCR11,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03+A.MDB04+A.MDB05+A.MDB06+A.MDB07+A.MDB08+A.MDB09+A.MDB10+A.MDB11,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03+A.MCR04+A.MCR05+A.MCR06+A.MCR07+A.MCR08+A.MCR09+A.MCR10+A.MCR11,                                                                        
        VLR_MDB         = A.MDB11,
        VLR_MCR         = A.MCR11,
        VLR_FINAL       = A.SF11,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03+A.RECO04+RECOR04+RECOA04+A.RECO05+RECOR05+RECOA05+A.RECO06+RECOR06+RECOA06
                          + A.RECO07+RECOR07+RECOA07+A.RECO08+RECOR08+RECOA08+A.RECO09+RECOR09+RECOA09+A.RECO10+RECOR10+RECOA10
                          -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10),
        VLR_RECOA_ACU    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09+ A.RECO10+RECO11
                           -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10+DISRECO11),
        VLR_RECOR_ACU    = A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+
                           RECOA08+RECOR08+RECOA09+RECOR09+RECOA10+RECOR10+RECOA11+RECOR11,
        VLR_RECO_MES    = A.RECO11,
        VLR_RECOA_MES    = A.RECOA11,
        VLR_RECOR_MES    = A.RECOR11,
        VLR_RECO_TOT    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06+ A.RECO07+A.RECO08+A.RECO09+A.RECO10+A.RECO11+ A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+
                          A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+RECOA08+RECOR08+RECOA09+RECOR09+RECOA10+RECOR10+RECOA11+RECOR11 -
                          (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10+DISRECO11),
        VLR_RECO_POR    = CASE WHEN A.SF11 = 0 THEN 0 ELSE ((A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 + A.RECO10 + A.RECO11)*100)/A.SF11 END,
        VLR_RECA_ACU    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECA05+RECAA05+RECAR05+
                          RECA06+RECAA06+RECAR06+RECA07+RECAA07+RECAR07+RECA08+RECAA08+RECAR08+RECA09+RECAA09+RECAR09+RECA10+RECAA10,
        VLR_RECAA_ACU    = A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07 + A.RECA08+ A.RECA09+ A.RECA10+ A.RECA11,
        VLR_RECAR_ACU    = A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+
                           RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08+RECAA09+RECAR09+RECAA10+RECAR10+RECAA11+RECAR11,
        VLR_RECA_MES    = A.RECA11,
        VLR_RECAA_MES    = A.RECAA11,
        VLR_RECAR_MES    = A.RECAR11,
        VLR_RECA_TOT    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+RECA05+RECA06+RECA07+RECA08+RECA09+RECA10+RECA11+ A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+
                          RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08+RECAA09+RECAR09+RECAA10+RECAR10+RECAA11+RECAR11,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 + A.RECO10 + A.RECO11 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07 + A.RECA08 + A.RECA09 + A.RECA10 + A.RECA11)*100)/(A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 + A.RECO10 + A.RECO11) END,
        VLR_APROPIACION = (SF11+DISRECO11) -((RECO01+RECO02+RECO03+RECO04+RECO05+RECO06+RECO07+RECO08+RECO09+RECO10+RECO11+RECOA01+RECOA02+RECOA03+RECOA04+RECOA05+RECOA06+RECOA07+RECOA08+RECOA09+RECOA10+RECOA11
                           +RECOR01+RECOR02+RECOR03+RECOR04+RECOR05+RECOR06+RECOR07+RECOR08+RECOR09+RECOR10+RECOR11)
                          -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10+DISRECO11)),
        VLR_PORCOBRAR   =(A.RECO01+A.RECOA01+RECOR01+A.RECO02+A.RECOA02+RECOR02+A.RECO03+A.RECOA03+RECOR03+A.RECO04+A.RECOA04+RECOR04+A.RECO05+A.RECOA05+RECOR05 +
						        +A.RECO06+A.RECOA06+RECOR06+A.RECO07+A.RECOA07+RECOR07+A.RECO08+A.RECOA08+RECOR08+A.RECO09+A.RECOA09+RECOR09+A.RECO10+A.RECOA10+RECOR10+A.RECO11+A.RECOA11+RECOR11) -
						       (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10+DISRECO11) -
						       (A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03+A.RECA04+A.RECAA04+RECAR04+A.RECA05+A.RECAA05+RECAR05+
						       +A.RECA06+A.RECAA06+RECAR06+A.RECA07+A.RECAA07+RECAR07+A.RECA08+A.RECAA08+RECAR08+A.RECA09+A.RECAA09+RECAR09+A.RECA10+A.RECAA10+RECAR10+A.RECA11+A.RECAA11+RECAR11),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO
 UNION ALL
 SELECT COMPANIA        = A.COMPANIA,
        CCOSTO          = A.CCOSTO,
        CONSECUTIVO     = A.CONSECUTIVO,
        MES             = 12,
        IDTIPOMOV       = A.IDTIPOMOV,
        RUBRO           = A.RUBRO,
        RECURSO         = B.RECURSO,
        NOMRUBRO        = B.NOMRUBRO,
        PTPTO_INICIAL   = A.SI01,
        VLR_INICIAL     = A.SI12,
        VLR_TDB         = A.TDB12,
        VLR_TCR         = A.TCR12,
        VLR_ACU_MDB		= A.MDB01+ A.MDB02+A.MDB03+A.MDB04+A.MDB05+A.MDB06+A.MDB07+A.MDB08+A.MDB09+A.MDB10+A.MDB11+A.MDB12,
        VLR_ACU_MCR		= A.MCR01+ A.MCR02+A.MCR03+A.MCR04+A.MCR05+A.MCR06+A.MCR07+A.MCR08+A.MCR09+A.MCR10+A.MCR11+A.MCR12,                                                                               
        VLR_MDB         = A.MDB12,
        VLR_MCR         = A.MCR12,
        VLR_FINAL       = A.SF12,
        VLR_RECO_ACU    = A.RECO01+A.RECOA01+RECOR01 + A.RECO02 + A.RECOA02+RECOR02 + A.RECO03 + A.RECOA03+RECOR03+A.RECO04+RECOR04+RECOA04+A.RECO05+RECOR05+RECOA05+A.RECO06+RECOR06+RECOA06
                          + A.RECO07+RECOR07+RECOA07+A.RECO08+RECOR08+RECOA08+A.RECO09+RECOR09+RECOA09+A.RECO10+RECOR10+RECOA10+A.RECO11+RECOR11+RECOA11
                          -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10+DISRECO11),
        VLR_RECO_ACU    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09+ A.RECO10+RECO11+RECO12
                           -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10+DISRECO11+DISRECO12),
        VLR_RECO_ACU    = A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+ A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+
                           RECOA08+RECOR08+RECOA09+RECOR09+RECOA10+RECOR10+RECOA11+RECOR11+RECOA12+RECOR12,
        VLR_RECO_MES    = A.RECO12,
        VLR_RECOA_MES   = A.RECOA12,
        VLR_RECOR_MES   = A.RECOR12,
        VLR_RECO_TOT    = A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06+ A.RECO07+A.RECO08+A.RECO09+A.RECO10+A.RECO11+A.RECO12+ A.RECOA01 +RECOR01+ A.RECOA02 +RECOR02+ A.RECOA03 +RECOR03+
                          A.RECOA04+RECOR04+RECOA05+RECOR05+RECOA06+RECOR06+RECOA07+RECOR07+RECOA08+RECOR08+RECOA09+RECOR09+RECOA10+RECOR10+RECOA11+RECOR11+RECOA12+RECOR12 -
                          (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10+DISRECO11+DISRECO12),
        VLR_RECO_POR    = CASE WHEN A.SF12 = 0 THEN 0 ELSE ((A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 + A.RECO10 + A.RECO11 + A.RECO12)*100)/A.SF12 END,
        VLR_RECA_ACU    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECA05+RECAA05+RECAR05+
                          RECA06+RECAA06+RECAR06+RECA07+RECAA07+RECAR07+RECA08+RECAA08+RECAR08+RECA09+RECAA09+RECAR09+RECA10+RECAA10+RECA11+RECAA11,
        VLR_RECAA_ACU   = A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07 + A.RECA08+ A.RECA09+ A.RECA10+ A.RECA11+ A.RECA12,
        VLR_RECAR_ACU   = A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+
                           RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08+RECAA09+RECAR09+RECAA10+RECAR10+RECAA11+RECAR11
                           +RECAA12+RECAR12,
        VLR_RECA_MES    = A.RECA12,
        VLR_RECAA_MES   = A.RECAA12,
        VLR_RECAR_MES   = A.RECAR12,
        VLR_RECA_TOT    = A.RECA01 + A.RECA02 + A.RECA03+RECA04+RECA05+RECA06+RECA07+RECA08+RECA09+RECA10+RECA11+RECA12
                        + A.RECAA01 + A.RECAR01+A.RECAA02 +A.RECAR02+ A.RECAA03+RECAR03+RECAA04+RECAR04+RECAA05+RECAR05+
                          RECAA06+RECAR06+RECAA07+RECAR07+RECAA08+RECAR08+RECAA09+RECAR09+RECAA10+RECAR10
                          +RECAA11+RECAR11+RECAA12+RECAR12,
        VLR_RECA_POR    = CASE WHEN A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 + A.RECO10 + A.RECO11 + A.RECO12 = 0 THEN 0 ELSE ((A.RECA01 + A.RECA02 + A.RECA03 + A.RECA04 + A.RECA05 + A.RECA06 + A.RECA07 + A.RECA08 + A.RECA09 + A.RECA10 + A.RECA11 + A.RECA12)*100)/(A.RECO01 + A.RECO02 + A.RECO03 + A.RECO04 + A.RECO05 + A.RECO06 + A.RECO07 + A.RECO08 + A.RECO09 + A.RECO10 + A.RECO11 + A.RECO12)END,
        VLR_APROPIACION = (SF12+DISRECO12) -((RECO01+RECO02+RECO03+RECO04+RECO05+RECO06+RECO07+RECO08+RECO09+RECO10+RECO11+RECO12+RECOA01+RECOA02+RECOA03+RECOA04+RECOA05+RECOA06+RECOA07+RECOA08+RECOA09+RECOA10+RECOA11+RECOA12
                           +RECOR01+RECOR02+RECOR03+RECOR04+RECOR05+RECOR06+RECOR07+RECOR08+RECOR09+RECOR10+RECOR11+RECOR12)
                          -(DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10+DISRECO11+DISRECO12)),
        VLR_PORCOBRAR   = (A.RECO01+A.RECOA01+RECOR01+A.RECO02+A.RECOA02+RECOR02+A.RECO03+A.RECOA03+RECOR03+A.RECO04+A.RECOA04+RECOR04+A.RECO05+A.RECOA05+RECOR05 +
						        +A.RECO06+A.RECOA06+RECOR06+A.RECO07+A.RECOA07+RECOR07+A.RECO08+A.RECOA08+RECOR08+A.RECO09+A.RECOA09+RECOR09+A.RECO10+A.RECOA10+RECOR10+A.RECO11+A.RECOA11+RECOR11+A.RECO12+A.RECOA12+RECOR12) -
						       (DISRECO01+DISRECO02+DISRECO03+DISRECO04+DISRECO05+DISRECO06+DISRECO07+DISRECO08+DISRECO09+DISRECO10+DISRECO11+DISRECO12) -
						       (A.RECA01+A.RECAA01+RECAR01+A.RECA02+A.RECAA02+RECAR02+A.RECA03+A.RECAA03+RECAR03+A.RECA04+A.RECAA04+RECAR04+A.RECA05+A.RECAA05+RECAR05+
						       +A.RECA06+A.RECAA06+RECAR06+A.RECA07+A.RECAA07+RECAR07+A.RECA08+A.RECAA08+RECAR08+A.RECA09+A.RECAA09+RECAR09+A.RECA10+A.RECAA10+RECAR10+A.RECA11+A.RECAA11+RECAR11+A.RECA12+A.RECAA12+RECAR12),
        RUBRO_ID        = A.RUBRO_ID,
        ORDEN           = B.ORDEN
 FROM PTPTOI A LEFT JOIN PTRUB  B ON A.RUBRO_ID=B.RUBRO_ID
    --A.COMPANIA=B.COMPANIA AND A.CLASE=B.CLASE AND A.RUBRO=B.RUBRO AND A.CONSECUTIVO=B.CONSECUTIVO




