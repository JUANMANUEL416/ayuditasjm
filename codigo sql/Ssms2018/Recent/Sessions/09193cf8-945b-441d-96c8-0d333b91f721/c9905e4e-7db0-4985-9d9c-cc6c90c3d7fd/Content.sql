
SELECT  * FROM #A

ALTER TABLE #A ADD TIPO_ID VARCHAR(4)

UPDATE #A SET TIPO_ID='CC' WHERE IDTERCERO<>'10233716'

UPDATE #A SET IDTERCERO='10233716' WHERE IDTERCERO='10233716-CE'

SELECT DBO.FNK_COLUMNAS_TABLAS('TER')

SELECT  * INTO #B FROM TER WHERE NIT='1152455628'

ALTER TABLE TER ENABLE TRIGGER ALL
INSERT INTO TER(IDTERCERO, RAZONSOCIAL, NIT, DV, TIPO_ID, IDALTERNA1, IDALTERNA2, DIRECCION, NATJURIDICA, CIUDAD, TELEFONOS, FAX, APA, F_INSCRIPTO, F_RENOVACION, F_VENCIMIENT, R_LEGAL, TIPO_ID_R, NIT_R,  ESTADO, REQAUTORIZA, CUENTA, ZONA, CIA, ACT_ECONOMICA, ENVIODICAJA, MODOCOPAGO, EMPIDMODELOPC, DIASVTO, ESEXTRANJERO, CLASIFICADOR, IDGRUPOIMP, AUTORETENEDOR, GRANCONTRIBUYENTE,  EMAIL, URL, NOMBRES_R_LEGAL, P_APELLIDO_R_LEGAL, S_APELLIDO_R_LEGAL, DE_NIT_R_LEGAL, IDACTIVIDAD, TIPOREGIMEN, MSUCURSALES, FORMAPRE, CODIGO_ARP, NORAD, TIPOAPORTANTE, CODOPERADOR,  CODIGO_AFP, CODIGO_CCF, ASESOR_AFI, ASESOR_MTO, FNAC_RLEGAL, HOBBIE_RL, PROF_RL, EMAIL_RL, TIPOID_TH, NID_TH, DE_NIT_TH, NOMBRES_TH, P_APELLIDO_TH, S_APELLIDO_TH, FNAC_TH,  HOBBIE_TH, PROF_TH, EMAIL_TH, ITFC, CNSITFC, HOMOLOGO, PNOMBRE, SNOMBRE, PAPELLIDO, SAPELLIDO, CUE_BANCARIA, TIPO_CUE, BANCO, SUCURSAL, NIIF_VTAEQUIEFECTIVOS, MANFACT, CTAVIGENCIAANTE,  EMAILRECIBOFE, COD_RESP_FISCAL, MANEXO, PREFIJOXML, SUFIJOXML, SIIF, SIIFCODIGOPCI, SIIFCONTRATO, SIIFCORREOSUPER, MEDIOPAGO, RUC, USUCREA, FECHACREA, CRONICO, CONTRATOID_MP,  PYM)
SELECT #A.IDTERCERO, #A.RAZSONSOCIAL, #A.IDTERCERO,DBO.FNK_CALCULA_DV(#A.IDTERCERO),#A.TIPO_ID, IDALTERNA1, IDALTERNA2, #A.DIRECCION, NATJURIDICA, CIUDAD, #A.TELEFONO, FAX, APA, F_INSCRIPTO, F_RENOVACION, F_VENCIMIENT, R_LEGAL, TIPO_ID_R, NIT_R,  ESTADO, REQAUTORIZA, CUENTA, ZONA, CIA, ACT_ECONOMICA, ENVIODICAJA, MODOCOPAGO, EMPIDMODELOPC, DIASVTO, ESEXTRANJERO, CLASIFICADOR, IDGRUPOIMP, AUTORETENEDOR, GRANCONTRIBUYENTE,  #A.EMAIL, URL, NOMBRES_R_LEGAL, P_APELLIDO_R_LEGAL, S_APELLIDO_R_LEGAL, DE_NIT_R_LEGAL, IDACTIVIDAD, TIPOREGIMEN, MSUCURSALES, FORMAPRE, CODIGO_ARP, NORAD, TIPOAPORTANTE, CODOPERADOR,  CODIGO_AFP, CODIGO_CCF, ASESOR_AFI, ASESOR_MTO, FNAC_RLEGAL, HOBBIE_RL, PROF_RL, EMAIL_RL, TIPOID_TH, NID_TH, DE_NIT_TH, NOMBRES_TH, P_APELLIDO_TH, S_APELLIDO_TH, FNAC_TH,  HOBBIE_TH, PROF_TH, EMAIL_TH, ITFC, CNSITFC, HOMOLOGO, NULL, NULL, NULL, NULL, CUE_BANCARIA, TIPO_CUE, BANCO, SUCURSAL, NIIF_VTAEQUIEFECTIVOS, MANFACT, CTAVIGENCIAANTE,  EMAILRECIBOFE, COD_RESP_FISCAL, MANEXO, PREFIJOXML, SUFIJOXML, SIIF, SIIFCODIGOPCI, SIIFCONTRATO, SIIFCORREOSUPER, MEDIOPAGO, RUC, USUCREA, FECHACREA, CRONICO, CONTRATOID_MP,  PYM
FROM #A,#B

SELECT *FROM #A WHERE EXISTS(SELECT * FROM TER WHERE #A.IDTERCERO=NIT AND TER.IDTERCERO<>TER.NIT)

SELECT  *FROM TER WHERE IDTERCERO IN(SELECT  * FROM #C)

SELECT IDTERCERO, DBO.FNK_SEPARA_NOMBRES(RAZSONSOCIAL,1), 
DBO.FNK_SEPARA_NOMBRES(RAZSONSOCIAL,2), 
DBO.FNK_SEPARA_NOMBRES(RAZSONSOCIAL,3), 
DBO.FNK_SEPARA_NOMBRES(RAZSONSOCIAL,4)
FROM #A WHERE NOT EXISTS(SELECT  * FROM NEMP WHERE #A.IDTERCERO=NEMP.DOCIDEMPLEADO)