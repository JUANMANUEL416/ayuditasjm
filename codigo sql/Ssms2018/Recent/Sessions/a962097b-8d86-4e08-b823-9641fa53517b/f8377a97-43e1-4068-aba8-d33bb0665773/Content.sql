use kpcem

SELECT TOP 10 * FROM API_LOG WHERE USUARIO='JJIMENEZ' ORDER BY ITEM DESC

SELECT IART.IDARTICULO
	,IART.DESCRIPCION
	,COALESCE(IART.PCOSTO, 0) PCOSTO
	,IART.IDITAR
	,ITAR.DESCRIPCION [ITAR_DESC]
	,IART.ESTADO
	,IART.ESTRANSFORMABLE
	,IART.IDUNIDAD
	,COALESCE(TGEN.DESCRIPCION, 'No Aplica') [UNI_DESC]
	,IART.IDFABRICANTE
	,IART.CODCUM
	,ITAR.DESCRIPCION TIPOARTICULO
	,ITAR.IDITAR
FROM [dbo].[IART]
INNER JOIN ITAR ON IART.IDITAR = ITAR.IDITAR
LEFT JOIN TGEN ON IART.IDUNIDAD = TGEN.CODIGO
	AND TGEN.TABLA = 'General'
	AND TGEN.CAMPO = 'PRESENTAUNIDOSIS'
LEFT JOIN ITAR ON ITAR.IDITAR = IART.IDITAR
WHERE (
		IART.IDARTICULO LIKE '%%%%'
		OR IART.DESCRIPCION LIKE '%%%%'
		)
	AND IART.ESTADO = 'Activo'
	AND PRINCIPAL = CASE 
		WHEN COALESCE(MPRINCIPAL, 0) = 1
			THEN 0
		ELSE PRINCIPAL
		END
	AND EXISTS (
		SELECT *
		FROM IBODS
		WHERE TIPO = 'ITAR'
			AND VALOR = IART.IDITAR
			AND ACCESO = 'Si'
			AND IDBODEGA = '011'
		)
ORDER BY IART.IDARTICULO ASC OFFSET(1 - 1) * 10 ROWS

FETCH NEXT 10 ROWS ONLY