SELECT MCP.ANO, MCP.MES, SUM(CASE TIPO WHEN 'DB' THEN VALOR ELSE 0 END)  AS DEBITO, SUM(CASE TIPO WHEN 'CR' THEN VALOR ELSE 0 END)  AS CREDITO, 
       SUM(CASE TIPO WHEN 'DB' THEN VALOR ELSE 0 END) -  SUM(CASE TIPO WHEN 'CR' THEN VALOR ELSE 0 END) AS DIF
FROM   MCH INNER JOIN MCP ON MCH.NROCOMPROBANTE = MCP.NROCOMPROBANTE
WHERE  MCP.ESTADO  = 2
AND    MCP.ANULADO = 0
AND    MCP.ANO = '2012'
GROUP BY MCP.ANO, MCP.MES



SELECT MCp.*
FROM   MCH INNER JOIN MCP ON MCH.NROCOMPROBANTE = MCP.NROCOMPROBANTE
            LEFT JOIN CUE ON MCH.CUENTA = CUE.CUENTA
WHERE  MCP.ESTADO  = 2
AND    MCP.ANULADO = 0
AND    MCP.ANO = '2012'
AND    MCP.MES = 12
AND    CUE.TIPO <> 'Detalle'

SELECT * 
FROM   MCP 
WHERE  MCP.ANO = '2012' 
AND    MES = 12
AND    MCP.MES <> MONTH(MCP.FECHACONTABLE)

SELECT CUE.CUENTA, CUE.TIPO, CUE.CUENTA_SUMA, X.TIPO 
FROM   CUE INNER JOIN CUE X ON CUE.CUENTA_SUMA = X.CUENTA
WHERE  CUE.TIPO =  'Detalle'
AND    X.TIPO   <> 'Suma'

SELECT CUE.CUENTA, CUE.TIPO, CUE.CUENTA_SUMA, X.TIPO 
FROM   CUE INNER JOIN CUE X ON CUE.CUENTA_SUMA = X.CUENTA
WHERE  CUE.TIPO =  'Suma'
AND    X.TIPO   <> 'Suma'


